var docx;(function(e){var r=function(){function r(){this.skipDeclaration=true;this.ignoreWidth=false;this.ignoreHeight=true;this.debug=false}r.prototype.parseDocumentAsync=function(e){var r=this;return e.files["word/document.xml"].async("string").then(function(e){return r.parseDocumentFile(e)})};r.prototype.parseStylesAsync=function(e){var r=this;return e.files["word/styles.xml"].async("string").then(function(e){return r.parseStylesFile(e)})};r.prototype.parseNumberingAsync=function(e){var r=this;var t=e.files["word/numbering.xml"];return t?t.async("string").then(function(e){return r.parseNumberingFile(e)}):null};r.prototype.parseDocumentFile=function(r){var t={domType:e.DomType.Document,children:[],style:{}};var n=a.byTagName(a.parse(r,this.skipDeclaration),"body");for(var s=0;s<n.childNodes.length;s++){var i=n.childNodes[s];switch(i.localName){case"p":t.children.push(this.parseParagraph(i));break;case"tbl":t.children.push(this.parseTable(i));break;case"sectPr":this.parseSectionProperties(i,t);break}}return t};r.prototype.parseStylesFile=function(e){var r=this;var t=[];var n=a.parse(e,this.skipDeclaration);a.foreach(n,function(e){switch(e.localName){case"style":t.push(r.parseStyle(e));break}});return t};r.prototype.parseStyle=function(e){var r=this;var t={id:a.stringAttr(e,"styleId"),target:null,basedOn:null,styles:[]};switch(a.stringAttr(e,"type")){case"paragraph":t.target="p";break;case"table":t.target="table";break}a.foreach(e,function(e){switch(e.localName){case"basedOn":t.basedOn=a.stringAttr(e,"val");break;case"pPr":t.styles.push({target:"p",values:r.parseDefaultProperties(e,{})});break;case"rPr":t.styles.push({target:"span",values:r.parseDefaultProperties(e,{})});break;case"tblPr":t.styles.push({target:"td",values:r.parseDefaultProperties(e,{})});break}});return t};r.prototype.parseNumberingFile=function(e){var r=this;var t=[];var n=a.parse(e,this.skipDeclaration);var s={};a.foreach(n,function(e){switch(e.localName){case"abstractNum":r.parseAbstractNumbering(e).forEach(function(e){return t.push(e)});break;case"num":var n=a.stringAttr(e,"numId");var i=a.nodeStringAttr(e,"abstractNumId","val");s[i]=n;break}});t.forEach(function(e){return e.id=s[e.id]});return t};r.prototype.parseAbstractNumbering=function(e){var r=this;var t=[];var n=a.stringAttr(e,"abstractNumId");a.foreach(e,function(e){switch(e.localName){case"lvl":t.push({id:n,level:a.stringAttr(e,"ilvl"),style:r.parseNumberingLevel(e)});break}});return t};r.prototype.parseNumberingLevel=function(e){var r=this;var t={};a.foreach(e,function(e){switch(e.localName){case"pPr":r.parseDefaultProperties(e,t);break;case"lvlText":break;case"numFmt":r.parseNumberingFormating(e,t);break}});return t};r.prototype.parseNumberingFormating=function(e,r){switch(a.stringAttr(e,"val")){case"bullet":r["list-style-type"]="disc";break;case"decimal":r["list-style-type"]="decimal";break;case"lowerLetter":r["list-style-type"]="lower-alpha";break;case"upperLetter":r["list-style-type"]="upper-alpha";break;case"lowerRoman":r["list-style-type"]="lower-roman";break;case"upperRoman":r["list-style-type"]="upper-roman";break;case"none":r["list-style-type"]="none";break}};r.prototype.parseSectionProperties=function(e,r){var t=this;a.foreach(e,function(e){switch(e.localName){case"pgMar":r.style["padding-left"]=a.sizeAttr(e,"left");r.style["padding-right"]=a.sizeAttr(e,"right");r.style["padding-top"]=a.sizeAttr(e,"top");r.style["padding-bottom"]=a.sizeAttr(e,"bottom");break;case"pgSz":if(!t.ignoreWidth)r.style["width"]=a.sizeAttr(e,"w");if(!t.ignoreHeight)r.style["height"]=a.sizeAttr(e,"h");break}})};r.prototype.parseParagraph=function(r){var t=this;var n={domType:e.DomType.Paragraph,children:[]};a.foreach(r,function(e){switch(e.localName){case"r":n.children.push(t.parseRun(e));break;case"pPr":t.parseParagraphProperties(e,n);break}});return n};r.prototype.parseParagraphProperties=function(e,r){var t=this;r.style=this.parseDefaultProperties(e,{},null,function(e){switch(e.localName){case"pStyle":r.className=a.stringAttr(e,"val");break;case"numPr":t.parseNumbering(e,r);break;case"rPr":break;default:return false}return true})};r.prototype.parseNumbering=function(e,r){a.foreach(e,function(e){switch(e.localName){case"numId":r.numberingId=a.stringAttr(e,"val");break;case"ilvl":r.numberingLevel=a.stringAttr(e,"val");break}})};r.prototype.parseRun=function(r){var t=this;var n={domType:e.DomType.Run};a.foreach(r,function(e){switch(e.localName){case"t":n.text=e.textContent;break;case"br":n.break=a.stringAttr(e,"type")||"textWrapping";break;case"tab":break;case"rPr":n.style=t.parseDefaultProperties(e,{},null);break}});return n};r.prototype.parseTable=function(r){var t=this;var n={domType:e.DomType.Table,children:[]};a.foreach(r,function(e){switch(e.localName){case"tr":n.children.push(t.parseTableRow(e));break;case"tblGrid":n.columns=t.parseTableColumns(e);break;case"tblPr":t.parseTableProperties(e,n);break}});return n};r.prototype.parseTableColumns=function(e){var r=[];a.foreach(e,function(e){switch(e.localName){case"gridCol":r.push({width:a.sizeAttr(e,"w")});break}});return r};r.prototype.parseTableProperties=function(e,r){r.style={};r.cellStyle={};this.parseDefaultProperties(e,r.style,r.cellStyle,function(e){switch(e.localName){case"tblStyle":r.className=a.stringAttr(e,"val");break;default:return false}return true})};r.prototype.parseTableRow=function(r){var t=this;var n={domType:e.DomType.Row,children:[]};a.foreach(r,function(e){switch(e.localName){case"tc":n.children.push(t.parseTableCell(e));break}});return n};r.prototype.parseTableCell=function(r){var t=this;var n={domType:e.DomType.Cell,children:[]};a.foreach(r,function(e){switch(e.localName){case"tbl":n.children.push(t.parseTable(e));break;case"p":n.children.push(t.parseParagraph(e));break;case"tcPr":t.parseTableCellProperties(e,n);break}});return n};r.prototype.parseTableCellProperties=function(e,r){r.style=this.parseDefaultProperties(e,{},null,function(e){switch(e.localName){case"gridSpan":r.span=a.intAttr(e,"val",null);break;default:return false}return true})};r.prototype.parseDefaultProperties=function(e,r,s,i){var l=this;if(r===void 0){r=null}if(s===void 0){s=null}if(i===void 0){i=null}r=r||{};a.foreach(e,function(e){switch(e.localName){case"jc":r["text-align"]=n.valueOfJc(e);break;case"color":r["color"]=a.stringAttr(e,"val");break;case"sz":r["font-size"]=a.sizeAttr(e,"val",t.FontSize);break;case"shd":r["background-color"]=a.stringAttr(e,"fill");break;case"highlight":r["background-color"]=a.stringAttr(e,"val");break;case"tcW":if(l.ignoreWidth)break;case"tblW":r["width"]=a.sizeAttr(e,"w");break;case"strike":r["text-decoration"]=n.valueOfStrike(e);break;case"b":r["font-weight"]=n.valueOfBold(e);break;case"i":r["font-style"]="italic";break;case"u":r["text-decoration"]="underline";break;case"ind":l.parseIndentation(e,r);break;case"rFonts":r["font-family"]=n.valueOfFonts(e);break;case"tblBorders":l.parseBorderProperties(e,s||r);break;case"tcBorders":l.parseBorderProperties(e,r);break;case"tblCellMar":l.parseMarginProperties(e,s||r);break;case"tblLayout":r["table-layout"]=n.valueOfTblLayout(e);break;case"vAlign":r["vertical-align"]=a.stringAttr(e,"val");break;case"spacing":l.parseSpacing(e,r);break;case"tabs":l.parseTabs(e,r);break;case"lang":break;default:if(i!=null)!i(e)&&l.debug&&console.log(e.localName);break}});return r};r.prototype.parseIndentation=function(e,r){var t=a.sizeAttr(e,"firstLine");var n=a.sizeAttr(e,"left");var s=a.sizeAttr(e,"start");var i=a.sizeAttr(e,"right");var l=a.sizeAttr(e,"end");if(t)r["text-intent"]=t;if(n||s)r["margin-left"]=n||s;if(i||l)r["margin-left"]=n||s};r.prototype.parseSpacing=function(e,r){var t=a.sizeAttr(e,"before");var n=a.sizeAttr(e,"after");var s=a.sizeAttr(e,"line");if(t)r["magrin-top"]=t;if(n)r["margin-bottom"]=n;if(s){r["line-height"]=s;r["min-height"]=s}};r.prototype.parseTabs=function(e,r){a.foreach(e,function(e){switch(e.localName){case"tab":{var t=a.stringAttr(e,"val");var s=a.sizeAttr(e,"pos");switch(t){case"left":r["magrin-left"]=n.addSize(r["magrin-left"],s);break;case"right":r["magrin-right"]=n.addSize(r["magrin-right"],s);break}}break}})};r.prototype.parseMarginProperties=function(e,r){a.foreach(e,function(e){switch(e.localName){case"left":r["padding-left"]=n.valueOfMargin(e);break;case"right":r["padding-right"]=n.valueOfMargin(e);break;case"top":r["padding-top"]=n.valueOfMargin(e);break;case"bottom":r["padding-bottom"]=n.valueOfMargin(e);break}})};r.prototype.parseBorderProperties=function(e,r){a.foreach(e,function(e){switch(e.localName){case"start":case"left":r["border-left"]=n.valueOfBorder(e);break;case"end":case"right":r["border-right"]=n.valueOfBorder(e);break;case"top":r["border-top"]=n.valueOfBorder(e);break;case"bottom":r["border-bottom"]=n.valueOfBorder(e);break}})};return r}();e.DocumentParser=r;var t;(function(e){e[e["FontSize"]=0]="FontSize";e[e["Dxa"]=1]="Dxa";e[e["Percent"]=2]="Percent"})(t||(t={}));var a=function(){function e(){}e.parse=function(e,r){if(r===void 0){r=true}if(r)e=e.replace(/<[?].*[?]>/,"");return(new DOMParser).parseFromString(e,"application/xml").firstChild};e.foreach=function(e,r){for(var t=0;t<e.childNodes.length;t++)r(e.childNodes.item(t))};e.byTagName=function(e,r){for(var t=0;t<e.childNodes.length;t++)if(e.childNodes[t].localName==r)return e.childNodes[t]};e.nodeStringAttr=function(r,t,a){var n=e.byTagName(r,t);return n?e.stringAttr(n,a):null};e.stringAttr=function(e,r){for(var t=0;t<e.attributes.length;t++){var a=e.attributes.item(t);if(a.localName==r)return a.value}return null};e.colorAttr=function(r,t,a){if(a===void 0){a=null}var n=e.stringAttr(r,t);switch(n){case"yellow":return n}return n?"#"+n:a};e.boolAttr=function(r,t,a){if(a===void 0){a=false}var n=e.stringAttr(r,t);switch(n){case"1":return true;case"0":return false}return a};e.intAttr=function(r,t,a){if(a===void 0){a=0}var n=e.stringAttr(r,t);return n?parseInt(e.stringAttr(r,t)):0};e.sizeAttr=function(r,a,n){if(n===void 0){n=t.Dxa}var s=e.stringAttr(r,a);if(s==null||s.indexOf("pt")>-1)return s;var i=parseInt(s);switch(n){case t.Dxa:return.05*i+"pt";case t.FontSize:return.5*i+"pt";case t.Percent:return.01*i+"%"}return s};return e}();var n=function(){function e(){}e.valueOfBold=function(e){return a.boolAttr(e,"val",true)?"bold":"normal"};e.valueOfStrike=function(e){return a.boolAttr(e,"val",true)?"line-through":"none"};e.valueOfMargin=function(e){return a.sizeAttr(e,"w")};e.valueOfBorder=function(e){var r=a.stringAttr(e,"val");if(r=="nil")return"none";var t=a.stringAttr(e,"color");var n=a.sizeAttr(e,"sz");return n+" solid "+(t=="auto"?"black":t)};e.valueOfTblLayout=function(e){var r=a.stringAttr(e,"val");return r=="fixed"?"fixed":"auto"};e.valueOfJc=function(e){var r=a.stringAttr(e,"val");switch(r){case"start":case"left":return"left";case"center":return"center";case"end":case"right":return"right";case"both":return"justify"}return r};e.valueOfFonts=function(e){var r=a.stringAttr(e,"ascii");return r};e.addSize=function(e,r){if(e==null)return r;if(r==null)return e;return"calc("+e+" + "+r+")"};return e}()})(docx||(docx={}));var docx;(function(e){(function(e){e[e["Document"]=0]="Document";e[e["Paragraph"]=1]="Paragraph";e[e["Run"]=2]="Run";e[e["Break"]=3]="Break";e[e["Table"]=4]="Table";e[e["Row"]=5]="Row";e[e["Cell"]=6]="Cell"})(e.DomType||(e.DomType={}));var r=e.DomType})(docx||(docx={}));var docx;(function(e){var r=function(){function r(e){this.htmlDocument=e;this.className="docx";this.digitTest=/^[0-9]/.test}r.prototype.processClassName=function(e){if(!e)return null;return this.className+"_"+e};r.prototype.processStyles=function(e){var r={};for(var t=0,a=e;t<a.length;t++){var n=a[t];n.id=this.processClassName(n.id);n.basedOn=this.processClassName(n.basedOn);r[n.id]=n}for(var s=0,i=e;s<i.length;s++){var n=i[s];if(n.basedOn){var l=r[n.basedOn];var o=function(e){u=l.styles.filter(function(r){return r.target==e.target});if(u&&u.length>0)c.copyStyleProperties(u[0].values,e.values)};var c=this;var u;for(var p=0,h=n.styles;p<h.length;p++){var f=h[p];o(f)}}}};r.prototype.processElement=function(r){if(r.children){for(var t=0,a=r.children;t<a.length;t++){var n=a[t];n.className=this.processClassName(n.className);if(n.domType==e.DomType.Table){this.processTable(n)}else{this.processElement(n)}}}};r.prototype.processTable=function(e){for(var r=0,t=e.children;r<t.length;r++){var a=t[r];for(var n=0,s=a.children;n<s.length;n++){var i=s[n];i.style=this.copyStyleProperties(e.cellStyle,i.style,["border-left","border-right","border-top","border-bottom","padding-left","padding-right","padding-top","padding-bottom"]);this.processElement(i)}}};r.prototype.copyStyleProperties=function(e,r,t){if(t===void 0){t=null}if(!e)return r;if(r==null)r={};if(t==null)t=Object.getOwnPropertyNames(e);for(var a=0,n=t;a<n.length;a++){var s=n[a];if(e.hasOwnProperty(s)&&!r.hasOwnProperty(s))r[s]=e[s]}return r};r.prototype.renderDocument=function(e){var r=this.htmlDocument.createElement("section");r.className=this.className;this.processElement(e);this.renderChildren(e,r);this.renderStyleValues(e.style,r);return r};r.prototype.renderWrapper=function(){var e=document.createElement("div");e.className=this.className+"-wrapper";return e};r.prototype.renderDefaultStyle=function(){var e=document.createElement("style");e.type="text/css";e.innerHTML="."+this.className+"-wrapper { background: gray; padding: 30px; display: flex; justify-content: center; } \n                ."+this.className+"-wrapper section."+this.className+" { background: white; box-shadow: 0 0 10px rgba(0, 0, 0, 0.5); }\n                ."+this.className+" { color: black; }\n                section."+this.className+" { box-sizing: border-box; }\n                ."+this.className+" table { border-collapse: collapse; }\n                ."+this.className+" table td, ."+this.className+" table th { vertical-align: top; }\n                ."+this.className+" p { margin: 0pt; }";return e};r.prototype.renderNumbering=function(e){var r="";for(var t=0,a=e;t<a.length;t++){var n=a[t];r+="."+this.className+"-num-"+n.id+"-"+n.level+" {\r\n display:list-item; list-style-position:inside; \r\n";for(var s in n.style){r+=s+": "+n.style[s]+";\r\n"}r+="} \r\n"}var i=document.createElement("style");i.type="text/css";i.innerHTML=r;return i};r.prototype.renderStyles=function(e){var r=document.createElement("style");var t="";r.type="text/css";this.processStyles(e);for(var a=0,n=e;a<n.length;a++){var s=n[a];for(var i=0,l=s.styles;i<l.length;i++){var o=l[i];if(s.isDefault)t+=s.target+", ";if(s.target==o.target)t+=s.target+"."+s.id+"{\r\n";else t+=s.target+"."+s.id+" "+o.target+"{\r\n";for(var c in o.values){t+=c+": "+o.values[c]+";\r\n"}t+="}\r\n"}}r.innerHTML=t;return r};r.prototype.renderElement=function(r){switch(r.domType){case e.DomType.Paragraph:return this.renderParagraph(r);case e.DomType.Run:return this.renderRun(r);case e.DomType.Table:return this.renderTable(r);case e.DomType.Row:return this.renderTableRow(r);case e.DomType.Cell:return this.renderTableCell(r)}return null};r.prototype.renderChildren=function(e,r){var t=this;var a=null;if(e.children!=null)a=e.children.map(function(e){return t.renderElement(e)}).filter(function(e){return e!=null});if(r&&a)a.forEach(function(e){return r.appendChild(e)});return a};r.prototype.renderParagraph=function(e){var r=this.htmlDocument.createElement("p");this.renderClass(e,r);this.renderChildren(e,r);this.renderStyleValues(e.style,r);if(e.numberingId&&e.numberingLevel){r.className=r.className+" "+this.className+"-num-"+e.numberingId+"-"+e.numberingLevel}return r};r.prototype.renderRun=function(e){if(e.break)return this.htmlDocument.createElement(e.break=="page"?"hr":"br");var r=this.htmlDocument.createElement("span");this.renderStyleValues(e.style,r);r.textContent=e.text;return r};r.prototype.renderTable=function(e){var r=this.htmlDocument.createElement("table");this.renderClass(e,r);this.renderChildren(e,r);this.renderStyleValues(e.style,r);if(e.columns)r.appendChild(this.renderTableColumns(e.columns));return r};r.prototype.renderTableColumns=function(e){var r=this.htmlDocument.createElement("colGroup");for(var t=0,a=e;t<a.length;t++){var n=a[t];var s=this.htmlDocument.createElement("col");if(n.width)s.width=n.width;r.appendChild(s)}return r};r.prototype.renderTableRow=function(e){var r=this.htmlDocument.createElement("tr");this.renderChildren(e,r);this.renderStyleValues(e.style,r);return r};r.prototype.renderTableCell=function(e){var r=this.htmlDocument.createElement("td");this.renderChildren(e,r);this.renderStyleValues(e.style,r);if(e.span)r.colSpan=e.span;return r};r.prototype.renderStyleValues=function(e,r){if(e==null)return;for(var t in e){if(e.hasOwnProperty(t)){r.style[t]=e[t]}}};r.prototype.renderClass=function(e,r){if(e.className)r.className=e.className};return r}();e.HtmlRenderer=r})(docx||(docx={}));var docx;(function(e){function r(r,a,n,s){if(n===void 0){n=null}if(s===void 0){s=null}var i=new e.DocumentParser;var l=new e.HtmlRenderer(window.document);if(s){i.ignoreWidth=s.ignoreWidth||i.ignoreWidth;i.ignoreHeight=s.ignoreHeight||i.ignoreHeight;i.debug=s.debug||i.debug}return JSZip.loadAsync(r).then(function(e){var r=[i.parseDocumentAsync(e),i.parseStylesAsync(e)];var t=i.parseNumberingAsync(e);if(t)r.push(t);return Promise.all(r)}).then(function(e){var r=s&&s.inWrapper!=null?s.inWrapper:true;n=n||a;t(n);t(a);n.appendChild(l.renderDefaultStyle());n.appendChild(l.renderStyles(e[1]));if(e[2])n.appendChild(l.renderNumbering(e[2]));var i=l.renderDocument(e[0]);if(r){var o=l.renderWrapper();o.appendChild(i);a.appendChild(o)}else{a.appendChild(i)}return{document:e[0],styles:e[1],numbering:e[2]}})}e.renderAsync=r;function t(e){while(e.firstChild){e.removeChild(e.firstChild)}}})(docx||(docx={}));