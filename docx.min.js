var __assign=this&&this.__assign||Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++){t=arguments[r];for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n))e[n]=t[n]}return e};var docx;(function(i){function e(e,t,r,a){if(r===void 0){r=null}if(a===void 0){a=null}var n=new i.DocumentParser;var s=new i.HtmlRenderer(window.document);if(a){n.ignoreWidth=a.ignoreWidth||n.ignoreWidth;n.ignoreHeight=a.ignoreHeight||n.ignoreHeight;n.debug=a.debug||n.debug;s.className=a.className||"docx";s.inWrapper=a&&a.inWrapper!=null?a.inWrapper:true}return o.load(e,n).then(function(e){s.render(e,t,r);return e})}i.renderAsync=e;var n;(function(e){e["Document"]="word/document.xml";e["Style"]="word/styles.xml";e["Numbering"]="word/numbering.xml";e["DocumentRelations"]="word/_rels/document.xml.rels";e["NumberingRelations"]="word/_rels/numbering.xml.rels";e["FontRelations"]="word/_rels/fontTable.xml.rels"})(n||(n={}));var o=function(){function t(){this.zip=new JSZip;this.docRelations=null;this.fontRelations=null;this.numRelations=null;this.styles=null;this.fonts=null;this.numbering=null;this.document=null}t.load=function(e,r){var a=new t;return a.zip.loadAsync(e).then(function(e){var t=[a.loadPart(n.DocumentRelations,r),a.loadPart(n.FontRelations,r),a.loadPart(n.NumberingRelations,r),a.loadPart(n.Style,r),a.loadPart(n.Numbering,r),a.loadPart(n.Document,r)];return Promise.all(t.filter(function(e){return e!=null})).then(function(e){return a})})};t.prototype.loadDocumentImage=function(e){return this.loadResource(this.docRelations,e).then(function(e){return e?"data:image/png;base64,"+e:null})};t.prototype.loadNumberingImage=function(e){return this.loadResource(this.numRelations,e).then(function(e){return e?"data:image/png;base64,"+e:null})};t.prototype.loadFont=function(e){return this.loadResource(this.fontRelations,e).then(function(e){return e?"data:application/vnd.ms-package.obfuscated-opentype;charset=utf-8;base64,"+e:null})};t.prototype.loadResource=function(e,t){var r=e.filter(function(e){return e.id==t});return r.length==0?Promise.resolve(null):this.zip.files["word/"+r[0].target].async("base64")};t.prototype.loadPart=function(t,r){var a=this;var e=this.zip.files[t];return e?e.async("string").then(function(e){switch(t){case n.FontRelations:a.fontRelations=r.parseDocumentRelationsFile(e);break;case n.DocumentRelations:a.docRelations=r.parseDocumentRelationsFile(e);break;case n.NumberingRelations:a.numRelations=r.parseDocumentRelationsFile(e);break;case n.Style:a.styles=r.parseStylesFile(e);break;case n.Numbering:a.numbering=r.parseNumberingFile(e);break;case n.Document:a.document=r.parseDocumentFile(e);break}return a}):null};return t}();i.Document=o})(docx||(docx={}));var docx;(function(c){c.autos={shd:"white",color:"black",highlight:"transparent"};var e=function(){function e(){this.skipDeclaration=true;this.ignoreWidth=false;this.ignoreHeight=true;this.debug=false}e.prototype.parseDocumentRelationsFile=function(e){var t=p.parse(e,this.skipDeclaration);return p.nodes(t).map(function(e){return{id:p.stringAttr(e,"Id"),type:s.valueOfRelType(e),target:p.stringAttr(e,"Target")}})};e.prototype.parseDocumentFile=function(e){var t={domType:c.DomType.Document,children:[],style:{}};var r=p.byTagName(p.parse(e,this.skipDeclaration),"body");for(var a=0;a<r.childNodes.length;a++){var n=r.childNodes[a];switch(n.localName){case"p":t.children.push(this.parseParagraph(n));break;case"tbl":t.children.push(this.parseTable(n));break;case"sectPr":this.parseSectionProperties(n,t);break}}return t};e.prototype.parseStylesFile=function(e){var t=this;var r=[];var a=p.parse(e,this.skipDeclaration);p.foreach(a,function(e){switch(e.localName){case"style":r.push(t.parseStyle(e));break;case"docDefaults":r.push(t.parseDefaultStyles(e));break}});return r};e.prototype.parseDefaultStyles=function(e){var a=this;var n={id:null,name:null,target:null,basedOn:null,styles:[]};p.foreach(e,function(e){switch(e.localName){case"rPrDefault":var t=p.byTagName(e,"rPr");if(t)n.styles.push({target:"span",values:a.parseDefaultProperties(t,{})});break;case"pPrDefault":var r=p.byTagName(e,"pPr");if(r)n.styles.push({target:"p",values:a.parseDefaultProperties(r,{})});break}});return n};e.prototype.parseStyle=function(e){var n=this;var s={id:p.className(e,"styleId"),isDefault:p.boolAttr(e,"default"),name:null,target:null,basedOn:null,styles:[]};switch(p.stringAttr(e,"type")){case"paragraph":s.target="p";break;case"table":s.target="table";break;case"character":s.target="span";break}p.foreach(e,function(e){switch(e.localName){case"basedOn":s.basedOn=p.stringAttr(e,"val");break;case"name":s.name=p.stringAttr(e,"val");break;case"pPr":s.styles.push({target:"p",values:n.parseDefaultProperties(e,{})});break;case"rPr":s.styles.push({target:"span",values:n.parseDefaultProperties(e,{})});break;case"tblPr":case"tcPr":s.styles.push({target:"td",values:n.parseDefaultProperties(e,{})});break;case"tblStylePr":for(var t=0,r=n.parseTableStyle(e);t<r.length;t++){var a=r[t];s.styles.push(a)}break;case"rsid":case"qFormat":case"hidden":case"semiHidden":case"unhideWhenUsed":case"autoRedefine":case"uiPriority":break;default:n.debug&&console.warn("DOCX: Unknown style element: "+e.localName)}});return s};e.prototype.parseTableStyle=function(e){var t=this;var r=[];var a=p.stringAttr(e,"type");var n="";switch(a){case"firstRow":n="tr.first-row";break;case"lastRow":n="tr.last-row";break;case"firstCol":n="td.first-col";break;case"lastCol":n="td.last-col";break;case"band1Vert":n="td.odd-col";break;case"band2Vert":n="td.even-col";break;case"band1Horz":n="tr.odd-row";break;case"band2Horz":n="tr.even-row";break;default:return[]}p.foreach(e,function(e){switch(e.localName){case"pPr":r.push({target:n+" p",values:t.parseDefaultProperties(e,{})});break;case"rPr":r.push({target:n+" span",values:t.parseDefaultProperties(e,{})});break;case"tblPr":case"tcPr":r.push({target:n,values:t.parseDefaultProperties(e,{})});break}});return r};e.prototype.parseNumberingFile=function(e){var a=this;var n=[];var t=p.parse(e,this.skipDeclaration);var s={};var i=[];p.foreach(t,function(e){switch(e.localName){case"abstractNum":a.parseAbstractNumbering(e,i).forEach(function(e){return n.push(e)});break;case"numPicBullet":i.push(a.parseNumberingPicBullet(e));break;case"num":var t=p.stringAttr(e,"numId");var r=p.nodeStringAttr(e,"abstractNumId","val");s[r]=t;break}});n.forEach(function(e){return e.id=s[e.id]});return n};e.prototype.parseNumberingPicBullet=function(e){var t=p.byTagName(e,"pict");var r=t&&p.byTagName(t,"shape");var a=r&&p.byTagName(r,"imagedata");return a?{id:p.intAttr(e,"numPicBulletId"),src:p.stringAttr(a,"id"),style:p.stringAttr(r,"style")}:null};e.prototype.parseAbstractNumbering=function(e,t){var r=this;var a=[];var n=p.stringAttr(e,"abstractNumId");p.foreach(e,function(e){switch(e.localName){case"lvl":a.push(r.parseNumberingLevel(n,e,t));break}});return a};e.prototype.parseNumberingLevel=function(e,t,r){var a=this;var n={id:e,level:p.intAttr(t,"ilvl"),style:{}};p.foreach(t,function(e){switch(e.localName){case"pPr":a.parseDefaultProperties(e,n.style);break;case"lvlPicBulletId":var t=p.intAttr(e,"val");n.bullet=r.filter(function(e){return e.id==t})[0];break;case"lvlText":n.levelText=p.stringAttr(e,"val");break;case"numFmt":n.format=p.stringAttr(e,"val");break}});return n};e.prototype.parseSectionProperties=function(e,t){var r=this;p.foreach(e,function(e){switch(e.localName){case"pgMar":t.style["padding-left"]=p.sizeAttr(e,"left");t.style["padding-right"]=p.sizeAttr(e,"right");t.style["padding-top"]=p.sizeAttr(e,"top");t.style["padding-bottom"]=p.sizeAttr(e,"bottom");break;case"pgSz":if(!r.ignoreWidth)t.style["width"]=p.sizeAttr(e,"w");if(!r.ignoreHeight)t.style["height"]=p.sizeAttr(e,"h");break}})};e.prototype.parseParagraph=function(e){var t=this;var r={domType:c.DomType.Paragraph,children:[]};p.foreach(e,function(e){switch(e.localName){case"r":r.children.push(t.parseRun(e,r));break;case"hyperlink":r.children.push(t.parseHyperlink(e,r));break;case"bookmarkStart":r.children.push(t.parseBookmark(e));break;case"pPr":t.parseParagraphProperties(e,r);break}});return r};e.prototype.parseParagraphProperties=function(e,t){var r=this;this.parseDefaultProperties(e,t.style={},null,function(e){switch(e.localName){case"pStyle":t.className=p.className(e,"val");break;case"numPr":r.parseNumbering(e,t);break;case"framePr":r.parseFrame(e,t);break;case"tabs":r.parseTabs(e,t);break;case"rPr":break;default:return false}return true})};e.prototype.parseNumbering=function(e,t){p.foreach(e,function(e){switch(e.localName){case"numId":t.numberingId=p.stringAttr(e,"val");break;case"ilvl":t.numberingLevel=p.intAttr(e,"val");break}})};e.prototype.parseFrame=function(e,t){var r=p.stringAttr(e,"dropCap");if(r=="drop")t.style["float"]="left"};e.prototype.parseBookmark=function(e){var t={domType:c.DomType.Run};t.id=p.stringAttr(e,"name");return t};e.prototype.parseHyperlink=function(e,t){var r=this;var a={domType:c.DomType.Hyperlink,parent:t,children:[]};var n=p.stringAttr(e,"anchor");if(n)a.href="#"+n;p.foreach(e,function(e){switch(e.localName){case"r":a.children.push(r.parseRun(e,a));break}});return a};e.prototype.parseRun=function(e,t){var r=this;var a={domType:c.DomType.Run,parent:t};p.foreach(e,function(e){switch(e.localName){case"t":a.text=e.textContent;break;case"br":a.break=p.stringAttr(e,"type")||"textWrapping";break;case"tab":a.tab=true;break;case"drawing":var t=r.parseDrawing(e);if(t)a.children=[t];break;case"rPr":r.parseRunProperties(e,a);break}});return a};e.prototype.parseRunProperties=function(e,t){this.parseDefaultProperties(e,t.style={},null,function(e){switch(e.localName){case"rStyle":t.className=p.className(e,"val");break;case"vertAlign":switch(p.stringAttr(e,"val")){case"subscript":t.wrapper="sub";break;case"superscript":t.wrapper="sup";break}break;default:return false}return true})};e.prototype.parseDrawing=function(e){for(var t=0,r=p.nodes(e);t<r.length;t++){var a=r[t];switch(a.localName){case"inline":case"anchor":return this.parseDrawingWrapper(a)}}};e.prototype.parseDrawingWrapper=function(e){var t={domType:c.DomType.Drawing,children:[],style:{}};var r=e.localName=="anchor";for(var a=0,n=p.nodes(e);a<n.length;a++){var s=n[a];switch(s.localName){case"extent":t.style["width"]=p.sizeAttr(s,"cx",u.Emu);t.style["height"]=p.sizeAttr(s,"cy",u.Emu);break;case"positionH":break;case"positionV":break;case"graphic":var i=this.parseGraphic(s);if(i)t.children.push(i);break}}return t};e.prototype.parseGraphic=function(e){var t=p.byTagName(e,"graphicData");for(var r=0,a=p.nodes(t);r<a.length;r++){var n=a[r];switch(n.localName){case"pic":return this.parsePicture(n)}}return null};e.prototype.parsePicture=function(e){var t={domType:c.DomType.Image,src:"",style:{}};var r=p.byTagName(e,"blipFill");var a=p.byTagName(r,"blip");t.src=p.stringAttr(a,"embed");var n=p.byTagName(e,"spPr");var s=p.byTagName(n,"xfrm");for(var i=0,o=p.nodes(s);i<o.length;i++){var l=o[i];switch(l.localName){case"ext":t.style["width"]=p.sizeAttr(l,"cx",u.Emu);t.style["height"]=p.sizeAttr(l,"cy",u.Emu);break;case"off":t.style["left"]=p.sizeAttr(l,"x",u.Emu);t.style["top"]=p.sizeAttr(l,"y",u.Emu);break}}return t};e.prototype.parseTable=function(e){var t=this;var r={domType:c.DomType.Table,children:[]};p.foreach(e,function(e){switch(e.localName){case"tr":r.children.push(t.parseTableRow(e));break;case"tblGrid":r.columns=t.parseTableColumns(e);break;case"tblPr":t.parseTableProperties(e,r);break}});return r};e.prototype.parseTableColumns=function(e){var t=[];p.foreach(e,function(e){switch(e.localName){case"gridCol":t.push({width:p.sizeAttr(e,"w")});break}});return t};e.prototype.parseTableProperties=function(e,t){t.style={};t.cellStyle={};this.parseDefaultProperties(e,t.style,t.cellStyle,function(e){switch(e.localName){case"tblStyle":t.className=p.className(e,"val");break;default:return false}return true});switch(t.style["text-align"]){case"center":delete t.style["text-align"];t.style["margin-left"]="auto";t.style["margin-right"]="auto";break;case"right":delete t.style["text-align"];t.style["margin-left"]="auto";break}};e.prototype.parseTableRow=function(e){var t=this;var r={domType:c.DomType.Row,children:[]};p.foreach(e,function(e){switch(e.localName){case"tc":r.children.push(t.parseTableCell(e));break;case"trPr":t.parseTableRowProperties(e,r);break}});return r};e.prototype.parseTableRowProperties=function(e,t){t.style=this.parseDefaultProperties(e,{},null,function(e){switch(e.localName){case"cnfStyle":t.className=s.classNameOfCnfStyle(e);break;default:return false}return true})};e.prototype.parseTableCell=function(e){var t=this;var r={domType:c.DomType.Cell,children:[]};p.foreach(e,function(e){switch(e.localName){case"tbl":r.children.push(t.parseTable(e));break;case"p":r.children.push(t.parseParagraph(e));break;case"tcPr":t.parseTableCellProperties(e,r);break}});return r};e.prototype.parseTableCellProperties=function(e,t){t.style=this.parseDefaultProperties(e,{},null,function(e){switch(e.localName){case"gridSpan":t.span=p.intAttr(e,"val",null);break;case"vMerge":break;case"cnfStyle":t.className=s.classNameOfCnfStyle(e);break;default:return false}return true})};e.prototype.parseDefaultProperties=function(e,t,r,a){var n=this;if(t===void 0){t=null}if(r===void 0){r=null}if(a===void 0){a=null}t=t||{};p.foreach(e,function(e){switch(e.localName){case"jc":t["text-align"]=s.valueOfJc(e);break;case"textAlignment":t["vertical-align"]=s.valueOfTextAlignment(e);break;case"color":t["color"]=p.colorAttr(e,"val",null,c.autos.color);break;case"sz":t["font-size"]=p.sizeAttr(e,"val",u.FontSize);break;case"shd":t["background-color"]=p.colorAttr(e,"fill",null,c.autos.shd);break;case"highlight":t["background-color"]=p.colorAttr(e,"val",null,c.autos.highlight);break;case"tcW":if(n.ignoreWidth)break;case"tblW":t["width"]=s.valueOfSize(e,"w");break;case"trHeight":n.parseTrHeight(e,t);break;case"strike":t["text-decoration"]=s.valueOfStrike(e);break;case"b":t["font-weight"]=s.valueOfBold(e);break;case"i":t["font-style"]="italic";break;case"u":n.parseUnderline(e,t);break;case"ind":n.parseIndentation(e,t);break;case"rFonts":n.parseFont(e,t);break;case"tblBorders":n.parseBorderProperties(e,r||t);break;case"tblCellSpacing":t["border-spacing"]=s.valueOfMargin(e);t["border-collapse"]="separate";break;case"pBdr":n.parseBorderProperties(e,t);break;case"tcBorders":n.parseBorderProperties(e,t);break;case"noWrap":break;case"tblCellMar":case"tcMar":n.parseMarginProperties(e,r||t);break;case"tblLayout":t["table-layout"]=s.valueOfTblLayout(e);break;case"vAlign":t["vertical-align"]=p.stringAttr(e,"val");break;case"spacing":n.parseSpacing(e,t);break;case"lang":case"noProof":case"webHidden":break;default:if(a!=null&&!a(e))n.debug&&console.warn("DOCX: Unknown document element: "+e.localName);break}});return t};e.prototype.parseUnderline=function(e,t){var r=p.stringAttr(e,"val");if(r==null||r=="none")return;switch(r){case"dash":case"dashDotDotHeavy":case"dashDotHeavy":case"dashedHeavy":case"dashLong":case"dashLongHeavy":case"dotDash":case"dotDotDash":t["text-decoration-style"]="dashed";break;case"dotted":case"dottedHeavy":t["text-decoration-style"]="dotted";break;case"double":t["text-decoration-style"]="double";break;case"single":case"thick":t["text-decoration"]="underline";break;case"wave":case"wavyDouble":case"wavyHeavy":t["text-decoration-style"]="wavy";break;case"words":t["text-decoration"]="underline";break}var a=p.colorAttr(e,"color");if(a)t["text-decoration-color"]=a};e.prototype.parseFont=function(e,t){var r=p.stringAttr(e,"ascii");if(r)t["font-family"]=r};e.prototype.parseIndentation=function(e,t){var r=p.sizeAttr(e,"firstLine");var a=p.sizeAttr(e,"left");var n=p.sizeAttr(e,"start");var s=p.sizeAttr(e,"right");var i=p.sizeAttr(e,"end");if(r)t["text-indent"]=r;if(a||n)t["margin-left"]=a||n;if(s||i)t["margin-right"]=s||i};e.prototype.parseSpacing=function(e,t){var r=p.sizeAttr(e,"before");var a=p.sizeAttr(e,"after");var n=p.sizeAttr(e,"line");if(r)t["margin-top"]=r;if(a)t["margin-bottom"]=a;if(n){t["line-height"]=n;t["min-height"]=n}};e.prototype.parseTabs=function(e,t){t.tabs=p.nodes(e,"tab").map(function(e){return{position:p.sizeAttr(e,"pos"),leader:p.stringAttr(e,"leader"),style:p.stringAttr(e,"val")}})};e.prototype.parseMarginProperties=function(e,t){p.foreach(e,function(e){switch(e.localName){case"left":t["padding-left"]=s.valueOfMargin(e);break;case"right":t["padding-right"]=s.valueOfMargin(e);break;case"top":t["padding-top"]=s.valueOfMargin(e);break;case"bottom":t["padding-bottom"]=s.valueOfMargin(e);break}})};e.prototype.parseTrHeight=function(e,t){switch(p.stringAttr(e,"hRule")){case"exact":t["height"]=p.sizeAttr(e,"val");break;case"atLeast":default:t["height"]=p.sizeAttr(e,"val");break}};e.prototype.parseBorderProperties=function(e,t){p.foreach(e,function(e){switch(e.localName){case"start":case"left":t["border-left"]=s.valueOfBorder(e);break;case"end":case"right":t["border-right"]=s.valueOfBorder(e);break;case"top":t["border-top"]=s.valueOfBorder(e);break;case"bottom":t["border-bottom"]=s.valueOfBorder(e);break}})};return e}();c.DocumentParser=e;var u;(function(e){e[e["FontSize"]=0]="FontSize";e[e["Dxa"]=1]="Dxa";e[e["Emu"]=2]="Emu";e[e["Border"]=3]="Border";e[e["Percent"]=4]="Percent"})(u||(u={}));var p=function(){function s(){}s.parse=function(e,t){if(t===void 0){t=true}if(t)e=e.replace(/<[?].*[?]>/,"");return(new DOMParser).parseFromString(e,"application/xml").firstChild};s.nodes=function(e,t){if(t===void 0){t=null}var r=[];for(var a=0;a<e.childNodes.length;a++){var n=e.childNodes[a];if(t==null||n.localName==t)r.push(n)}return r};s.foreach=function(e,t){for(var r=0;r<e.childNodes.length;r++)t(e.childNodes[r])};s.byTagName=function(e,t){for(var r=0;r<e.childNodes.length;r++)if(e.childNodes[r].localName==t)return e.childNodes[r]};s.nodeStringAttr=function(e,t,r){var a=s.byTagName(e,t);return a?s.stringAttr(a,r):null};s.stringAttr=function(e,t){var r=e.attributes;for(var a=0;r&&a<r.length;a++){var n=r.item(a);if(n.localName==t)return n.value}return null};s.colorAttr=function(e,t,r,a){if(r===void 0){r=null}if(a===void 0){a="black"}var n=s.stringAttr(e,t);switch(n){case"yellow":return n;case"auto":return a}return n?"#"+n:r};s.boolAttr=function(e,t,r){if(r===void 0){r=false}var a=s.stringAttr(e,t);switch(a){case"1":return true;case"0":return false}return r};s.intAttr=function(e,t,r){if(r===void 0){r=0}var a=s.stringAttr(e,t);return a?parseInt(s.stringAttr(e,t)):0};s.sizeAttr=function(e,t,r){if(r===void 0){r=u.Dxa}var a=s.stringAttr(e,t);if(a==null||a.indexOf("pt")>-1)return a;var n=parseInt(a);switch(r){case u.Dxa:return(.05*n).toFixed(2)+"pt";case u.Emu:return(n/12700).toFixed(2)+"pt";case u.FontSize:return(.5*n).toFixed(2)+"pt";case u.Border:return(.125*n).toFixed(2)+"pt";case u.Percent:return(.02*n).toFixed(2)+"%"}return a};s.className=function(e,t){var r=s.stringAttr(e,t);return r&&r.replace(/[ .]+/g,"-").replace(/[&]+/g,"and")};return s}();var s=function(){function n(){}n.valueOfBold=function(e){return p.boolAttr(e,"val",true)?"bold":"normal"};n.valueOfSize=function(e,t){var r=u.Dxa;switch(p.stringAttr(e,"type")){case"dxa":break;case"pct":r=u.Percent;break}return p.sizeAttr(e,t,r)};n.valueOfStrike=function(e){return p.boolAttr(e,"val",true)?"line-through":"none"};n.valueOfMargin=function(e){return p.sizeAttr(e,"w")};n.valueOfRelType=function(e){switch(p.sizeAttr(e,"Type")){case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings":return c.DomRelationshipType.Settings;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme":return c.DomRelationshipType.Theme;case"http://schemas.microsoft.com/office/2007/relationships/stylesWithEffects":return c.DomRelationshipType.StylesWithEffects;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles":return c.DomRelationshipType.Styles;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable":return c.DomRelationshipType.FontTable;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image":return c.DomRelationshipType.Image;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/webSettings":return c.DomRelationshipType.WebSettings}return c.DomRelationshipType.Unknown};n.valueOfBorder=function(e){var t=p.stringAttr(e,"val");if(t=="nil")return"none";var r=p.colorAttr(e,"color");var a=p.sizeAttr(e,"sz",u.Border);return a+" solid "+(r=="auto"?"black":r)};n.valueOfTblLayout=function(e){var t=p.stringAttr(e,"val");return t=="fixed"?"fixed":"auto"};n.classNameOfCnfStyle=function(e){var t="";var r=p.stringAttr(e,"val");if(r[0]=="1")t+=" first-row";if(r[1]=="1")t+=" last-row";if(r[2]=="1")t+=" first-col";if(r[3]=="1")t+=" last-col";if(r[4]=="1")t+=" odd-col";if(r[5]=="1")t+=" even-col";if(r[6]=="1")t+=" odd-row";if(r[7]=="1")t+=" even-row";if(r[8]=="1")t+=" ne-cell";if(r[9]=="1")t+=" nw-cell";if(r[10]=="1")t+=" se-cell";if(r[11]=="1")t+=" sw-cell";return t.trim()};n.valueOfJc=function(e){var t=p.stringAttr(e,"val");switch(t){case"start":case"left":return"left";case"center":return"center";case"end":case"right":return"right";case"both":return"justify"}return t};n.valueOfTextAlignment=function(e){var t=p.stringAttr(e,"val");switch(t){case"auto":case"baseline":return"baseline";case"top":return"top";case"center":return"middle";case"bottom":return"bottom"}return t};n.addSize=function(e,t){if(e==null)return t;if(t==null)return e;return"calc("+e+" + "+t+")"};n.checkMask=function(e,t){return(e&t)==t};n.classNameOftblLook=function(e){var t=p.stringAttr(e,"val");var r=parseInt(t,16);var a="";if(n.checkMask(r,32))a+=" first-row";if(n.checkMask(r,64))a+=" last-row";if(n.checkMask(r,128))a+=" first-col";if(n.checkMask(r,256))a+=" last-col";if(!n.checkMask(r,512))a+=" odd-row even-row";if(!n.checkMask(r,1024))a+=" odd-col even-col";return a.trim()};return n}()})(docx||(docx={}));var docx;(function(e){var t;(function(e){e[e["Document"]=0]="Document";e[e["Paragraph"]=1]="Paragraph";e[e["Run"]=2]="Run";e[e["Break"]=3]="Break";e[e["Table"]=4]="Table";e[e["Row"]=5]="Row";e[e["Cell"]=6]="Cell";e[e["Hyperlink"]=7]="Hyperlink";e[e["Drawing"]=8]="Drawing";e[e["Image"]=9]="Image"})(t=e.DomType||(e.DomType={}));var r;(function(e){e[e["Settings"]=0]="Settings";e[e["Theme"]=1]="Theme";e[e["StylesWithEffects"]=2]="StylesWithEffects";e[e["Styles"]=3]="Styles";e[e["FontTable"]=4]="FontTable";e[e["Image"]=5]="Image";e[e["WebSettings"]=6]="WebSettings";e[e["Unknown"]=7]="Unknown"})(r=e.DomRelationshipType||(e.DomRelationshipType={}))})(docx||(docx={}));var docx;(function(n){var e=function(){function e(e){this.htmlDocument=e;this.inWrapper=true;this.className="docx";this.digitTest=/^[0-9]/.test}e.prototype.render=function(e,t,r){if(r===void 0){r=null}this.document=e;r=r||t;this.clearElement(r);this.clearElement(t);r.appendChild(this.htmlDocument.createComment("docxjs library predefined styles"));r.appendChild(this.renderDefaultStyle());r.appendChild(this.htmlDocument.createComment("docx document styles"));r.appendChild(this.renderStyles(e.styles));if(e.numbering){r.appendChild(this.htmlDocument.createComment("docx document numbering styles"));r.appendChild(this.renderNumbering(e.numbering,r))}var a=this.renderDocument(e.document);if(this.inWrapper){var n=this.renderWrapper();n.appendChild(a);t.appendChild(n)}else{t.appendChild(a)}};e.prototype.clearElement=function(e){while(e.firstChild){e.removeChild(e.firstChild)}};e.prototype.processClassName=function(e){if(!e)return this.className;return this.className+"_"+e};e.prototype.processStyles=function(e){var t={};for(var r=0,a=e;r<a.length;r++){var n=a[r];n.id=this.processClassName(n.id);n.basedOn=this.processClassName(n.basedOn);t[n.id]=n}for(var s=0,i=e;s<i.length;s++){var n=i[s];if(n.basedOn){var o=t[n.basedOn];var l=function(t){u=o.styles.filter(function(e){return e.target==t.target});if(u&&u.length>0)c.copyStyleProperties(u[0].values,t.values)};var c=this,u;for(var p=0,h=n.styles;p<h.length;p++){var d=h[p];l(d)}}}};e.prototype.processElement=function(e){if(e.children){for(var t=0,r=e.children;t<r.length;t++){var a=r[t];a.className=this.processClassName(a.className);if(a.domType==n.DomType.Table){this.processTable(a)}else{this.processElement(a)}}}};e.prototype.processTable=function(e){for(var t=0,r=e.children;t<r.length;t++){var a=r[t];for(var n=0,s=a.children;n<s.length;n++){var i=s[n];i.style=this.copyStyleProperties(e.cellStyle,i.style,["border-left","border-right","border-top","border-bottom","padding-left","padding-right","padding-top","padding-bottom"]);this.processElement(i)}}};e.prototype.copyStyleProperties=function(e,t,r){if(r===void 0){r=null}if(!e)return t;if(t==null)t={};if(r==null)r=Object.getOwnPropertyNames(e);for(var a=0,n=r;a<n.length;a++){var s=n[a];if(e.hasOwnProperty(s)&&!t.hasOwnProperty(s))t[s]=e[s]}return t};e.prototype.renderDocument=function(e){var t=this.htmlDocument.createElement("section");t.className=this.className;this.processElement(e);this.renderChildren(e,t);this.renderStyleValues(e.style,t);return t};e.prototype.renderWrapper=function(){var e=document.createElement("div");e.className=this.className+"-wrapper";return e};e.prototype.renderDefaultStyle=function(){var e="."+this.className+"-wrapper { background: gray; padding: 30px; display: flex; justify-content: center; } \n                ."+this.className+"-wrapper section."+this.className+" { background: white; box-shadow: 0 0 10px rgba(0, 0, 0, 0.5); }\n                ."+this.className+" { color: black; }\n                section."+this.className+" { box-sizing: border-box; }\n                ."+this.className+" table { border-collapse: collapse; }\n                ."+this.className+" table td, ."+this.className+" table th { vertical-align: top; }\n                ."+this.className+" p { margin: 0pt; }";return this.renderStyle(e)};e.prototype.renderNumbering=function(e,a){var n=this;var t="";var s=[];var r=function(){o="p."+i.numberingClass(p.id,p.level);l="none";if(p.levelText&&p.format=="decimal"){var e=i.numberingCounter(p.id,p.level);if(p.level>0){t+=i.styleToString("p."+i.numberingClass(p.id,p.level-1),{"counter-reset":e})}else{s.push(e)}t+=i.styleToString(o+":before",{content:i.levelTextToContent(p.levelText,p.id),"counter-increment":e});t+=i.styleToString(o,__assign({display:"list-item","list-style-position":"inside","list-style-type":"none"},p.style))}else if(p.bullet){var r=("--"+i.className+"-"+p.bullet.src).toLowerCase();t+=i.styleToString(o+":before",{content:"' '",display:"inline-block",background:"var("+r+")"},p.bullet.style);i.document.loadNumberingImage(p.bullet.src).then(function(e){var t="."+n.className+"-wrapper { "+r+": url("+e+") }";a.appendChild(n.renderStyle(t))})}else{l=i.numFormatToCssValue(p.format)}t+=i.styleToString(o,__assign({display:"list-item","list-style-position":"inside","list-style-type":l},p.style))};var i=this,o,l;for(var c=0,u=e;c<u.length;c++){var p=u[c];r()}if(s.length>0){t+=this.styleToString("."+this.className+"-wrapper",{"counter-reset":s.join(" ")})}return this.renderStyle(t)};e.prototype.renderStyle=function(e){var t=document.createElement("style");t.type="text/css";t.innerHTML=e;return t};e.prototype.renderStyles=function(e){var t="";this.processStyles(e);for(var r=0,a=e;r<a.length;r++){var n=a[r];for(var s=0,i=n.styles;s<i.length;s++){var o=i[s];var l="";if(n.target==o.target)l+=n.target+"."+n.id;else if(n.target)l+=n.target+"."+n.id+" "+o.target;else l+="."+n.id+" "+o.target;if(n.isDefault&&n.target)l="."+this.className+" "+n.target+", "+l;t+=this.styleToString(l,o.values)}}return this.renderStyle(t)};e.prototype.renderElement=function(e,t){switch(e.domType){case n.DomType.Paragraph:return this.renderParagraph(e);case n.DomType.Run:return this.renderRun(e);case n.DomType.Table:return this.renderTable(e);case n.DomType.Row:return this.renderTableRow(e);case n.DomType.Cell:return this.renderTableCell(e);case n.DomType.Hyperlink:return this.renderHyperlink(e);case n.DomType.Drawing:return this.renderDrawing(e);case n.DomType.Image:return this.renderImage(e)}return null};e.prototype.renderChildren=function(t,r){var a=this;var e=null;if(t.children!=null)e=t.children.map(function(e){return a.renderElement(e,t)}).filter(function(e){return e!=null});if(r&&e)e.forEach(function(e){return r.appendChild(e)});return e};e.prototype.renderParagraph=function(e){var t=this.htmlDocument.createElement("p");this.renderClass(e,t);this.renderChildren(e,t);this.renderStyleValues(e.style,t);if(e.numberingId&&e.numberingLevel!=null){t.className=t.className+" "+this.numberingClass(e.numberingId,e.numberingLevel)}return t};e.prototype.renderHyperlink=function(e){var t=this.htmlDocument.createElement("a");this.renderChildren(e,t);this.renderStyleValues(e.style,t);if(e.href)t.href=e.href;return t};e.prototype.renderDrawing=function(e){var t=this.htmlDocument.createElement("div");t.style.display="inline-block";t.style.position="relative";this.renderChildren(e,t);this.renderStyleValues(e.style,t);return t};e.prototype.renderImage=function(e){var t=this.htmlDocument.createElement("img");t.style.position="absolute";this.renderStyleValues(e.style,t);if(this.document){this.document.loadDocumentImage(e.src).then(function(e){t.src=e})}return t};e.prototype.renderRun=function(e){if(e.break)return this.htmlDocument.createElement(e.break=="page"?"hr":"br");var t=this.htmlDocument.createElement("span");if(e.text)t.textContent=e.text;this.renderClass(e,t);this.renderChildren(e,t);this.renderStyleValues(e.style,t);if(e.id){t.id=e.id}if(e.tab){}else if(e.href){var r=this.htmlDocument.createElement("a");r.href=e.href;r.appendChild(t);return r}else if(e.wrapper){var a=this.htmlDocument.createElement(e.wrapper);a.appendChild(t);return a}return t};e.prototype.renderTable=function(e){var t=this.htmlDocument.createElement("table");this.renderClass(e,t);this.renderChildren(e,t);this.renderStyleValues(e.style,t);if(e.columns)t.appendChild(this.renderTableColumns(e.columns));return t};e.prototype.renderTableColumns=function(e){var t=this.htmlDocument.createElement("colGroup");for(var r=0,a=e;r<a.length;r++){var n=a[r];var s=this.htmlDocument.createElement("col");if(n.width)s.style.width=n.width+"px";t.appendChild(s)}return t};e.prototype.renderTableRow=function(e){var t=this.htmlDocument.createElement("tr");this.renderClass(e,t);this.renderChildren(e,t);this.renderStyleValues(e.style,t);return t};e.prototype.renderTableCell=function(e){var t=this.htmlDocument.createElement("td");this.renderClass(e,t);this.renderChildren(e,t);this.renderStyleValues(e.style,t);if(e.span)t.colSpan=e.span;return t};e.prototype.renderStyleValues=function(e,t){if(e==null)return;for(var r in e){if(e.hasOwnProperty(r)){t.style[r]=e[r]}}};e.prototype.renderClass=function(e,t){if(e.className)t.className=e.className};e.prototype.numberingClass=function(e,t){return this.className+"-num-"+e+"-"+t};e.prototype.styleToString=function(e,t,r){if(r===void 0){r=null}var a=e+" {\r\n";for(var n in t){a+="  "+n+": "+t[n]+";\r\n"}if(r)a+=";"+r;return a+"}\r\n"};e.prototype.numberingCounter=function(e,t){return this.className+"-num-"+e+"-"+t};e.prototype.levelTextToContent=function(e,r){var a=this;var t=e.replace(/%\d*/g,function(e){var t=parseInt(e.substring(1),10)-1;return'"counter('+a.numberingCounter(r,t)+')"'});return'"'+t+'"'};e.prototype.numFormatToCssValue=function(e){var t={none:"none",bullet:"disc",decimal:"decimal",lowerLetter:"lower-alpha",upperLetter:"upper-alpha",lowerRoman:"lower-roman",upperRoman:"upper-roman"};return t[e]||e};return e}();n.HtmlRenderer=e})(docx||(docx={}));