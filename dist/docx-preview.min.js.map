{"version":3,"sources":["webpack://docx/webpack/universalModuleDefinition","webpack://docx/webpack/bootstrap","webpack://docx/./node_modules/core-js/internals/global.js","webpack://docx/./node_modules/core-js/internals/descriptors.js","webpack://docx/./node_modules/core-js/internals/fails.js","webpack://docx/./node_modules/core-js/internals/is-object.js","webpack://docx/./node_modules/core-js/internals/has.js","webpack://docx/./node_modules/core-js/internals/create-non-enumerable-property.js","webpack://docx/./node_modules/core-js/internals/an-object.js","webpack://docx/./node_modules/core-js/internals/shared.js","webpack://docx/./node_modules/core-js/internals/to-indexed-object.js","webpack://docx/./node_modules/core-js/internals/object-define-property.js","webpack://docx/./node_modules/core-js/internals/set-global.js","webpack://docx/./node_modules/core-js/internals/hidden-keys.js","webpack://docx/./node_modules/core-js/internals/enum-bug-keys.js","webpack://docx/./node_modules/core-js/internals/object-get-own-property-descriptor.js","webpack://docx/./node_modules/core-js/internals/create-property-descriptor.js","webpack://docx/./node_modules/core-js/internals/indexed-object.js","webpack://docx/./node_modules/core-js/internals/classof-raw.js","webpack://docx/./node_modules/core-js/internals/require-object-coercible.js","webpack://docx/./node_modules/core-js/internals/to-primitive.js","webpack://docx/./node_modules/core-js/internals/ie8-dom-define.js","webpack://docx/./node_modules/core-js/internals/document-create-element.js","webpack://docx/./node_modules/core-js/internals/function-to-string.js","webpack://docx/./node_modules/core-js/internals/shared-key.js","webpack://docx/./node_modules/core-js/internals/uid.js","webpack://docx/./node_modules/core-js/internals/get-built-in.js","webpack://docx/./node_modules/core-js/internals/object-keys-internal.js","webpack://docx/./node_modules/core-js/internals/to-length.js","webpack://docx/./node_modules/core-js/internals/to-integer.js","webpack://docx/./node_modules/core-js/internals/well-known-symbol.js","webpack://docx/./src/dom/dom.ts","webpack://docx/./src/docx-preview.ts","webpack://docx/./src/document.ts","webpack://docx/external \"JSZip\"","webpack://docx/./node_modules/core-js/modules/es.array.find-index.js","webpack://docx/./node_modules/core-js/internals/export.js","webpack://docx/(webpack)/buildin/global.js","webpack://docx/./node_modules/core-js/internals/object-property-is-enumerable.js","webpack://docx/./node_modules/core-js/internals/redefine.js","webpack://docx/./node_modules/core-js/internals/is-pure.js","webpack://docx/./node_modules/core-js/internals/shared-store.js","webpack://docx/./node_modules/core-js/internals/internal-state.js","webpack://docx/./node_modules/core-js/internals/native-weak-map.js","webpack://docx/./node_modules/core-js/internals/copy-constructor-properties.js","webpack://docx/./node_modules/core-js/internals/own-keys.js","webpack://docx/./node_modules/core-js/internals/path.js","webpack://docx/./node_modules/core-js/internals/object-get-own-property-names.js","webpack://docx/./node_modules/core-js/internals/array-includes.js","webpack://docx/./node_modules/core-js/internals/to-absolute-index.js","webpack://docx/./node_modules/core-js/internals/object-get-own-property-symbols.js","webpack://docx/./node_modules/core-js/internals/is-forced.js","webpack://docx/./node_modules/core-js/internals/array-iteration.js","webpack://docx/./node_modules/core-js/internals/bind-context.js","webpack://docx/./node_modules/core-js/internals/a-function.js","webpack://docx/./node_modules/core-js/internals/to-object.js","webpack://docx/./node_modules/core-js/internals/array-species-create.js","webpack://docx/./node_modules/core-js/internals/is-array.js","webpack://docx/./node_modules/core-js/internals/native-symbol.js","webpack://docx/./node_modules/core-js/internals/add-to-unscopables.js","webpack://docx/./node_modules/core-js/internals/object-create.js","webpack://docx/./node_modules/core-js/internals/object-define-properties.js","webpack://docx/./node_modules/core-js/internals/object-keys.js","webpack://docx/./node_modules/core-js/internals/html.js","webpack://docx/./src/document-parser.ts","webpack://docx/./src/utils.ts","webpack://docx/./src/dom/common.ts","webpack://docx/./src/parser/common.ts","webpack://docx/./src/html-renderer.ts"],"names":["root","factory","exports","module","require","define","amd","window","__WEBPACK_EXTERNAL_MODULE__32__","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","it","Math","check","globalThis","self","global","Function","fails","a","exec","error","DESCRIPTORS","definePropertyModule","createPropertyDescriptor","f","isObject","TypeError","String","IS_PURE","store","undefined","push","version","copyright","IndexedObject","requireObjectCoercible","IE8_DOM_DEFINE","anObject","toPrimitive","nativeDefineProperty","O","P","Attributes","createNonEnumerableProperty","propertyIsEnumerableModule","toIndexedObject","has","nativeGetOwnPropertyDescriptor","getOwnPropertyDescriptor","bitmap","configurable","writable","classof","split","propertyIsEnumerable","toString","slice","input","PREFERRED_STRING","fn","val","valueOf","createElement","document","EXISTS","shared","uid","keys","id","postfix","random","path","aFunction","variable","namespace","method","arguments","length","indexOf","hiddenKeys","names","result","toInteger","min","argument","ceil","floor","isNaN","NATIVE_SYMBOL","DomType","DomRelationshipType","data","bodyContainer","styleContainer","userOptions","parser","DocumentParser","renderer","HtmlRenderer","options","ignoreHeight","ignoreWidth","breakPages","debug","className","inWrapper","Document","load","doc","render","PartType","zip","JSZip","docRelations","fontRelations","numRelations","styles","fonts","numbering","blob","loadAsync","then","z","files","loadPart","DocumentRelations","FontRelations","NumberingRelations","Style","Numbering","Promise","all","filter","x","loadDocumentImage","this","loadResource","loadNumberingImage","loadFont","relations","rel","resolve","target","async","part","xml","parseDocumentRelationsFile","parseStylesFile","parseNumberingFile","parseDocumentFile","$","$findIndex","findIndex","addToUnscopables","SKIPS_HOLES","Array","proto","forced","callbackfn","redefine","setGlobal","copyConstructorProperties","isForced","source","targetProperty","sourceProperty","descriptor","TARGET","GLOBAL","STATIC","stat","noTargetGet","sham","g","e","nativePropertyIsEnumerable","NASHORN_BUG","1","V","nativeFunctionToString","InternalStateModule","getInternalState","enforceInternalState","enforce","TEMPLATE","unsafe","simple","join","set","NATIVE_WEAK_MAP","objectHas","sharedKey","WeakMap","wmget","wmhas","wmset","metadata","STATE","getterFor","TYPE","state","type","test","ownKeys","getOwnPropertyDescriptorModule","getBuiltIn","getOwnPropertyNamesModule","getOwnPropertySymbolsModule","getOwnPropertySymbols","concat","internalObjectKeys","getOwnPropertyNames","toLength","toAbsoluteIndex","createMethod","IS_INCLUDES","$this","el","fromIndex","index","includes","max","integer","replacement","feature","detection","normalize","POLYFILL","NATIVE","string","replace","toLowerCase","toObject","arraySpeciesCreate","IS_MAP","IS_FILTER","IS_SOME","IS_EVERY","IS_FIND_INDEX","NO_HOLES","that","specificCreate","boundFunction","forEach","map","some","every","find","b","apply","isArray","SPECIES","wellKnownSymbol","originalArray","C","constructor","arg","UNSCOPABLES","ArrayPrototype","defineProperties","enumBugKeys","html","documentCreateElement","IE_PROTO","Empty","createDict","iframeDocument","iframe","style","display","appendChild","src","contentWindow","open","write","lt","close","F","Properties","objectKeys","autos","shd","color","highlight","SizeType","skipDeclaration","xmlString","xrels","parse","elements","stringAttr","values","valueOfRelType","domType","children","props","xbody","byTagName","foreach","elem","localName","parseParagraph","parseTable","parseSectionProperties","xstyles","parseStyle","parseDefaultStyles","node","basedOn","rPr","parseDefaultProperties","pPr","parseCommonProperties","namespaceURI","namespaces","wordml","getAttributeColorValue","fontSize","getAttributeLengthValue","LengthUsage","FontSize","isDefault","boolAttr","linked","aliases","parseTableStyle","console","warn","selector","xnums","mapping","bullets","parseAbstractNumbering","parseNumberingPicBullet","numId","abstractNumId","elementStringAttr","pict","shape","imagedata","intAttr","parseNumberingLevel","level","bullet","levelText","format","section","forEachElementNS","pageSize","width","height","orientation","getAttributeNS","pageMargins","left","right","top","bottom","header","footer","gutter","columns","parseColumns","numberOfColumns","getAttributeIntValue","space","separator","getAttributeBoolValue","equalWidth","Paragraph","parseRun","parseHyperlink","parseBookmark","parseParagraphProperties","paragraph","utils","addElementClass","classNameOfCnfStyle","sectionProps","parseNumbering","parseFrame","parseTabs","numberingId","numberingLevel","Run","parent","Hyperlink","anchor","href","text","textContent","break","tab","parseDrawing","parseRunProperties","run","wrapper","parseDrawingWrapper","Drawing","isAnchor","wrapType","simplePos","posX","relative","align","offset","posY","sizeAttr","Emu","pos","alignNode","offsetNode","sizeValue","parseGraphic","graphicData","parsePicture","Image","blipFill","blip","spPr","xfrm","Table","parseTableRow","parseTableColumns","parseTableProperties","table","cellStyle","classNameOftblLook","parseTablePosition","topFromText","bottomFromText","rightFromText","leftFromText","addSize","Row","parseTableCell","parseTableRowProperties","row","Cell","parseTableCellProperties","cell","span","childStyle","handler","valueOfJc","valueOfTextAlignment","colorAttr","valueOfSize","parseTrHeight","valueOfStrike","valueOfBold","parseUnderline","parseIndentation","parseFont","parseBorderProperties","valueOfMargin","parseMarginProperties","valueOfTblLayout","parseSpacing","col","ascii","firstLine","start","end","before","after","line","lineRule","toFixed","tabs","position","leader","output","valueOfBorder","DOMParser","parseFromString","firstChild","tagName","childNodes","nodeType","cb","nodeName","attrName","attributes","attr","item","defValue","autoColor","v","parseInt","Dxa","convertSize","intVal","Border","Percent","Settings","Theme","StylesWithEffects","Styles","FontTable","WebSettings","Unknown","trim","checkMask","num","mask","appendClass","classList","element","parseLength","usage","callback","defaultValue","htmlDocument","digitTest","removeAllElements","appendComment","renderDefaultStyle","renderStyles","renderNumbering","sectionElements","renderSections","renderWrapper","appentElements","processClassName","processStyles","stylesMap","baseStyle","baseValues","styleValues","copyStyleProperties","processElement","processTable","attrs","createSection","paddingLeft","renderLength","paddingRight","paddingTop","paddingBottom","minHeight","columnCount","columnGap","columnRule","splitBySection","sectionElement","sectProps","renderElements","current","breakIndex","newParagraph","createStyleElement","listStyleType","styleText","rootCounters","numberingClass","counter","numberingCounter","styleToString","levelTextToContent","numFormatToCssValue","subStyles","linkedStyle","subStyle","renderElement","renderParagraph","renderRun","renderTable","renderTableRow","renderTableCell","renderHyperlink","renderDrawing","renderImage","renderChildren","into","elems","renderClass","renderStyleValues","renderCommonProeprties","textIndent","link","renderTableColumns","colElem","colSpan","ouput","lvl","selectors","cssText","substring","container","removeChild","styleElement","innerHTML","comment","createComment"],"mappings":"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","file":"docx-preview.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"JSZip\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"JSZip\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"docx\"] = factory(require(\"JSZip\"));\n\telse\n\t\troot[\"docx\"] = factory(root[\"JSZip\"]);\n})(window, function(__WEBPACK_EXTERNAL_MODULE__32__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 30);\n","var check = function (it) {\n  return it && it.Math == Math && it;\n};\n\n// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nmodule.exports =\n  // eslint-disable-next-line no-undef\n  check(typeof globalThis == 'object' && globalThis) ||\n  check(typeof window == 'object' && window) ||\n  check(typeof self == 'object' && self) ||\n  check(typeof global == 'object' && global) ||\n  // eslint-disable-next-line no-new-func\n  Function('return this')();\n","var fails = require('../internals/fails');\n\n// Thank's IE8 for his funny defineProperty\nmodule.exports = !fails(function () {\n  return Object.defineProperty({}, 'a', { get: function () { return 7; } }).a != 7;\n});\n","module.exports = function (exec) {\n  try {\n    return !!exec();\n  } catch (error) {\n    return true;\n  }\n};\n","module.exports = function (it) {\n  return typeof it === 'object' ? it !== null : typeof it === 'function';\n};\n","var hasOwnProperty = {}.hasOwnProperty;\n\nmodule.exports = function (it, key) {\n  return hasOwnProperty.call(it, key);\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar definePropertyModule = require('../internals/object-define-property');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\n\nmodule.exports = DESCRIPTORS ? function (object, key, value) {\n  return definePropertyModule.f(object, key, createPropertyDescriptor(1, value));\n} : function (object, key, value) {\n  object[key] = value;\n  return object;\n};\n","var isObject = require('../internals/is-object');\n\nmodule.exports = function (it) {\n  if (!isObject(it)) {\n    throw TypeError(String(it) + ' is not an object');\n  } return it;\n};\n","var IS_PURE = require('../internals/is-pure');\nvar store = require('../internals/shared-store');\n\n(module.exports = function (key, value) {\n  return store[key] || (store[key] = value !== undefined ? value : {});\n})('versions', []).push({\n  version: '3.3.2',\n  mode: IS_PURE ? 'pure' : 'global',\n  copyright: '© 2019 Denis Pushkarev (zloirock.ru)'\n});\n","// toObject with fallback for non-array-like ES3 strings\nvar IndexedObject = require('../internals/indexed-object');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\n\nmodule.exports = function (it) {\n  return IndexedObject(requireObjectCoercible(it));\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar IE8_DOM_DEFINE = require('../internals/ie8-dom-define');\nvar anObject = require('../internals/an-object');\nvar toPrimitive = require('../internals/to-primitive');\n\nvar nativeDefineProperty = Object.defineProperty;\n\n// `Object.defineProperty` method\n// https://tc39.github.io/ecma262/#sec-object.defineproperty\nexports.f = DESCRIPTORS ? nativeDefineProperty : function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPrimitive(P, true);\n  anObject(Attributes);\n  if (IE8_DOM_DEFINE) try {\n    return nativeDefineProperty(O, P, Attributes);\n  } catch (error) { /* empty */ }\n  if ('get' in Attributes || 'set' in Attributes) throw TypeError('Accessors not supported');\n  if ('value' in Attributes) O[P] = Attributes.value;\n  return O;\n};\n","var global = require('../internals/global');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\n\nmodule.exports = function (key, value) {\n  try {\n    createNonEnumerableProperty(global, key, value);\n  } catch (error) {\n    global[key] = value;\n  } return value;\n};\n","module.exports = {};\n","// IE8- don't enum bug keys\nmodule.exports = [\n  'constructor',\n  'hasOwnProperty',\n  'isPrototypeOf',\n  'propertyIsEnumerable',\n  'toLocaleString',\n  'toString',\n  'valueOf'\n];\n","var DESCRIPTORS = require('../internals/descriptors');\nvar propertyIsEnumerableModule = require('../internals/object-property-is-enumerable');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar toPrimitive = require('../internals/to-primitive');\nvar has = require('../internals/has');\nvar IE8_DOM_DEFINE = require('../internals/ie8-dom-define');\n\nvar nativeGetOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\n// `Object.getOwnPropertyDescriptor` method\n// https://tc39.github.io/ecma262/#sec-object.getownpropertydescriptor\nexports.f = DESCRIPTORS ? nativeGetOwnPropertyDescriptor : function getOwnPropertyDescriptor(O, P) {\n  O = toIndexedObject(O);\n  P = toPrimitive(P, true);\n  if (IE8_DOM_DEFINE) try {\n    return nativeGetOwnPropertyDescriptor(O, P);\n  } catch (error) { /* empty */ }\n  if (has(O, P)) return createPropertyDescriptor(!propertyIsEnumerableModule.f.call(O, P), O[P]);\n};\n","module.exports = function (bitmap, value) {\n  return {\n    enumerable: !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable: !(bitmap & 4),\n    value: value\n  };\n};\n","var fails = require('../internals/fails');\nvar classof = require('../internals/classof-raw');\n\nvar split = ''.split;\n\n// fallback for non-array-like ES3 and non-enumerable old V8 strings\nmodule.exports = fails(function () {\n  // throws an error in rhino, see https://github.com/mozilla/rhino/issues/346\n  // eslint-disable-next-line no-prototype-builtins\n  return !Object('z').propertyIsEnumerable(0);\n}) ? function (it) {\n  return classof(it) == 'String' ? split.call(it, '') : Object(it);\n} : Object;\n","var toString = {}.toString;\n\nmodule.exports = function (it) {\n  return toString.call(it).slice(8, -1);\n};\n","// `RequireObjectCoercible` abstract operation\n// https://tc39.github.io/ecma262/#sec-requireobjectcoercible\nmodule.exports = function (it) {\n  if (it == undefined) throw TypeError(\"Can't call method on \" + it);\n  return it;\n};\n","var isObject = require('../internals/is-object');\n\n// `ToPrimitive` abstract operation\n// https://tc39.github.io/ecma262/#sec-toprimitive\n// instead of the ES6 spec version, we didn't implement @@toPrimitive case\n// and the second argument - flag - preferred type is a string\nmodule.exports = function (input, PREFERRED_STRING) {\n  if (!isObject(input)) return input;\n  var fn, val;\n  if (PREFERRED_STRING && typeof (fn = input.toString) == 'function' && !isObject(val = fn.call(input))) return val;\n  if (typeof (fn = input.valueOf) == 'function' && !isObject(val = fn.call(input))) return val;\n  if (!PREFERRED_STRING && typeof (fn = input.toString) == 'function' && !isObject(val = fn.call(input))) return val;\n  throw TypeError(\"Can't convert object to primitive value\");\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar fails = require('../internals/fails');\nvar createElement = require('../internals/document-create-element');\n\n// Thank's IE8 for his funny defineProperty\nmodule.exports = !DESCRIPTORS && !fails(function () {\n  return Object.defineProperty(createElement('div'), 'a', {\n    get: function () { return 7; }\n  }).a != 7;\n});\n","var global = require('../internals/global');\nvar isObject = require('../internals/is-object');\n\nvar document = global.document;\n// typeof document.createElement is 'object' in old IE\nvar EXISTS = isObject(document) && isObject(document.createElement);\n\nmodule.exports = function (it) {\n  return EXISTS ? document.createElement(it) : {};\n};\n","var shared = require('../internals/shared');\n\nmodule.exports = shared('native-function-to-string', Function.toString);\n","var shared = require('../internals/shared');\nvar uid = require('../internals/uid');\n\nvar keys = shared('keys');\n\nmodule.exports = function (key) {\n  return keys[key] || (keys[key] = uid(key));\n};\n","var id = 0;\nvar postfix = Math.random();\n\nmodule.exports = function (key) {\n  return 'Symbol(' + String(key === undefined ? '' : key) + ')_' + (++id + postfix).toString(36);\n};\n","var path = require('../internals/path');\nvar global = require('../internals/global');\n\nvar aFunction = function (variable) {\n  return typeof variable == 'function' ? variable : undefined;\n};\n\nmodule.exports = function (namespace, method) {\n  return arguments.length < 2 ? aFunction(path[namespace]) || aFunction(global[namespace])\n    : path[namespace] && path[namespace][method] || global[namespace] && global[namespace][method];\n};\n","var has = require('../internals/has');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar indexOf = require('../internals/array-includes').indexOf;\nvar hiddenKeys = require('../internals/hidden-keys');\n\nmodule.exports = function (object, names) {\n  var O = toIndexedObject(object);\n  var i = 0;\n  var result = [];\n  var key;\n  for (key in O) !has(hiddenKeys, key) && has(O, key) && result.push(key);\n  // Don't enum bug & hidden keys\n  while (names.length > i) if (has(O, key = names[i++])) {\n    ~indexOf(result, key) || result.push(key);\n  }\n  return result;\n};\n","var toInteger = require('../internals/to-integer');\n\nvar min = Math.min;\n\n// `ToLength` abstract operation\n// https://tc39.github.io/ecma262/#sec-tolength\nmodule.exports = function (argument) {\n  return argument > 0 ? min(toInteger(argument), 0x1FFFFFFFFFFFFF) : 0; // 2 ** 53 - 1 == 9007199254740991\n};\n","var ceil = Math.ceil;\nvar floor = Math.floor;\n\n// `ToInteger` abstract operation\n// https://tc39.github.io/ecma262/#sec-tointeger\nmodule.exports = function (argument) {\n  return isNaN(argument = +argument) ? 0 : (argument > 0 ? floor : ceil)(argument);\n};\n","var global = require('../internals/global');\nvar shared = require('../internals/shared');\nvar uid = require('../internals/uid');\nvar NATIVE_SYMBOL = require('../internals/native-symbol');\n\nvar Symbol = global.Symbol;\nvar store = shared('wks');\n\nmodule.exports = function (name) {\n  return store[name] || (store[name] = NATIVE_SYMBOL && Symbol[name]\n    || (NATIVE_SYMBOL ? Symbol : uid)('Symbol.' + name));\n};\n","export enum DomType {\r\n    Document,\r\n    Paragraph,\r\n    Run,\r\n    Break,\r\n    Table,\r\n    Row,\r\n    Cell,\r\n    Hyperlink,\r\n    Drawing,\r\n    Image\r\n}\r\n\r\nexport enum DomRelationshipType {\r\n    Settings,\r\n    Theme,\r\n    StylesWithEffects,\r\n    Styles,\r\n    FontTable,\r\n    Image,\r\n    WebSettings,\r\n    Unknown\r\n}\r\n\r\nexport interface IDomRelationship {\r\n    id: string;\r\n    type: DomRelationshipType;\r\n    target: string;\r\n}\r\n\r\nexport interface OpenXmlElement {\r\n    domType: DomType;\r\n    children?: OpenXmlElement[];\r\n    style?: IDomStyleValues;\r\n    className?: string;\r\n    parent?: OpenXmlElement;\r\n}\r\n\r\nexport interface DocxTab {\r\n    style: string;\r\n    leader: string;\r\n    position: string;\r\n}\r\n\r\nexport interface IDomHyperlink extends OpenXmlElement {\r\n    href?: string;\r\n}\r\n\r\nexport interface IDomRun extends OpenXmlElement {\r\n    id?: string;\r\n    break?: string;\r\n    wrapper?: string;\r\n    text?: string;\r\n    href?: string;\r\n    tab?: boolean;\r\n}\r\n\r\nexport interface IDomTable extends OpenXmlElement {\r\n    columns?: IDomTableColumn[];\r\n    cellStyle?: IDomStyleValues;\r\n}\r\n\r\nexport interface IDomTableRow extends OpenXmlElement {\r\n}\r\n\r\nexport interface IDomTableCell extends OpenXmlElement {\r\n    span?: number;\r\n}\r\n\r\nexport interface IDomImage extends OpenXmlElement {\r\n    src: string;\r\n}\r\n\r\nexport interface IDomTableColumn {\r\n    width?: string;\r\n}\r\n\r\nexport interface IDomStyle {\r\n    id: string;\r\n    name?: string;\r\n    aliases?: string[];\r\n    target: string;\r\n    basedOn?: string;\r\n    isDefault?: boolean;\r\n    styles: IDomSubStyle[];\r\n    linked?: string;\r\n}\r\n\r\nexport interface IDomSubStyle {\r\n    target: string;\r\n    values: IDomStyleValues;\r\n}\r\n\r\nexport interface IDomNumbering {\r\n    id: string;\r\n    level: number;\r\n    style: IDomStyleValues;\r\n    levelText?: string;\r\n    format?: string;\r\n    bullet?: NumberingPicBullet;\r\n}\r\n\r\nexport interface NumberingPicBullet {\r\n    id: number;\r\n    src: string;\r\n    style?: string;\r\n}\r\n\r\nexport interface IDomStyleValues {\r\n    [name: string]: string;\r\n}\r\n","import { Document } from './document';\r\nimport { DocumentParser } from './document-parser';\r\nimport { HtmlRenderer } from './html-renderer';\r\n\r\nexport interface Options {\r\n    inWrapper: boolean;\r\n    ignoreWidth: boolean;\r\n    ignoreHeight: boolean;\r\n    breakPages: boolean;\r\n    debug: boolean;\r\n    className: string;\r\n}\r\n\r\nexport async function renderAsync(data: Blob | any, bodyContainer: HTMLElement, styleContainer: HTMLElement = null, userOptions: Partial<Options> = null) {\r\n    var parser = new DocumentParser();\r\n    var renderer = new HtmlRenderer(window.document);\r\n\r\n    var options = { \r\n        ignoreHeight: false,\r\n        ignoreWidth: false,\r\n        breakPages: true,\r\n        debug: false,\r\n        className: \"docx\",\r\n        inWrapper: true,\r\n        ... userOptions\r\n    };\r\n\r\n    parser.ignoreWidth = options.ignoreWidth;\r\n    parser.debug = options.debug || parser.debug;\r\n\r\n    renderer.className = options.className || \"docx\";\r\n    renderer.inWrapper = options.inWrapper;\r\n\r\n    const doc = await Document.load(data, parser);\r\n    renderer.render(doc, bodyContainer, styleContainer, options);\r\n    return doc;\r\n}","import * as JSZip from 'jszip';\r\n\r\nimport \"core-js/modules/es.array.find-index\"\r\n\r\nimport { DocumentParser } from './document-parser';\r\nimport { IDomRelationship, IDomStyle, IDomNumbering } from './dom/dom';\r\nimport { Font } from './dom/common';\r\nimport { DocumentElement } from './dom/document';\r\n\r\nenum PartType {\r\n    Document = \"word/document.xml\",\r\n    Style = \"word/styles.xml\",\r\n    Numbering = \"word/numbering.xml\",\r\n    DocumentRelations = \"word/_rels/document.xml.rels\",\r\n    NumberingRelations = \"word/_rels/numbering.xml.rels\",\r\n    FontRelations = \"word/_rels/fontTable.xml.rels\",\r\n}\r\n\r\nexport class Document {\r\n    private zip: JSZip = new JSZip();\r\n\r\n    docRelations: IDomRelationship[] = null;\r\n    fontRelations: IDomRelationship[] = null;\r\n    numRelations: IDomRelationship[] = null;\r\n\r\n    styles: IDomStyle[] = null;\r\n    fonts: Font[] = null;\r\n    numbering: IDomNumbering[] = null;\r\n    document: DocumentElement = null;\r\n\r\n    static load(blob, parser: DocumentParser): PromiseLike<Document> {\r\n        var d = new Document();\r\n\r\n        return d.zip.loadAsync(blob).then(z => {\r\n            var files = [\r\n                d.loadPart(PartType.DocumentRelations, parser),\r\n                d.loadPart(PartType.FontRelations, parser),\r\n                d.loadPart(PartType.NumberingRelations, parser),\r\n                d.loadPart(PartType.Style, parser),\r\n                d.loadPart(PartType.Numbering, parser),\r\n                d.loadPart(PartType.Document, parser)\r\n            ];\r\n\r\n            return Promise.all(files.filter(x => x != null)).then(x => d);\r\n        });\r\n    }\r\n\r\n    loadDocumentImage(id: string): PromiseLike<string> {\r\n        return this.loadResource(this.docRelations, id).then(x => x ? (\"data:image/png;base64,\" + x) : null);\r\n    }\r\n\r\n    loadNumberingImage(id: string): PromiseLike<string> {\r\n        return this.loadResource(this.numRelations, id).then(x => x ? (\"data:image/png;base64,\" + x) : null);\r\n    }\r\n\r\n    loadFont(id: string): PromiseLike<string> {\r\n        return this.loadResource(this.fontRelations, id)\r\n            .then(x => x ? (\"data:application/vnd.ms-package.obfuscated-opentype;charset=utf-8;base64,\" + x) : null);\r\n    }\r\n\r\n    private loadResource(relations: IDomRelationship[], id: string) {\r\n        let rel = relations.filter(x => x.id == id);\r\n\r\n        return rel.length == 0 ? Promise.resolve(null) : this.zip.files[\"word/\" + rel[0].target].async(\"base64\");\r\n    }\r\n\r\n    private loadPart(part: PartType, parser: DocumentParser) {\r\n        var f = this.zip.files[part];\r\n\r\n        return f ? f.async(\"text\").then(xml => {\r\n            switch (part) {\r\n                case PartType.FontRelations:\r\n                    this.fontRelations = parser.parseDocumentRelationsFile(xml);\r\n                    break;\r\n\r\n                case PartType.DocumentRelations:\r\n                    this.docRelations = parser.parseDocumentRelationsFile(xml);\r\n                    break;\r\n\r\n                case PartType.NumberingRelations:\r\n                    this.numRelations = parser.parseDocumentRelationsFile(xml);\r\n                    break;\r\n\r\n                case PartType.Style:\r\n                    this.styles = parser.parseStylesFile(xml);\r\n                    break;\r\n\r\n                case PartType.Numbering:\r\n                    this.numbering = parser.parseNumberingFile(xml);\r\n                    break;\r\n\r\n                case PartType.Document:\r\n                    this.document = parser.parseDocumentFile(xml);\r\n                    break;\r\n            }\r\n\r\n            return this;\r\n        }) : null;\r\n    }\r\n}\r\n","module.exports = __WEBPACK_EXTERNAL_MODULE__32__;","'use strict';\nvar $ = require('../internals/export');\nvar $findIndex = require('../internals/array-iteration').findIndex;\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\nvar FIND_INDEX = 'findIndex';\nvar SKIPS_HOLES = true;\n\n// Shouldn't skip holes\nif (FIND_INDEX in []) Array(1)[FIND_INDEX](function () { SKIPS_HOLES = false; });\n\n// `Array.prototype.findIndex` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.findindex\n$({ target: 'Array', proto: true, forced: SKIPS_HOLES }, {\n  findIndex: function findIndex(callbackfn /* , that = undefined */) {\n    return $findIndex(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\n// https://tc39.github.io/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables(FIND_INDEX);\n","var global = require('../internals/global');\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar redefine = require('../internals/redefine');\nvar setGlobal = require('../internals/set-global');\nvar copyConstructorProperties = require('../internals/copy-constructor-properties');\nvar isForced = require('../internals/is-forced');\n\n/*\n  options.target      - name of the target object\n  options.global      - target is the global object\n  options.stat        - export as static methods of target\n  options.proto       - export as prototype methods of target\n  options.real        - real prototype method for the `pure` version\n  options.forced      - export even if the native feature is available\n  options.bind        - bind methods to the target, required for the `pure` version\n  options.wrap        - wrap constructors to preventing global pollution, required for the `pure` version\n  options.unsafe      - use the simple assignment of property instead of delete + defineProperty\n  options.sham        - add a flag to not completely full polyfills\n  options.enumerable  - export as enumerable property\n  options.noTargetGet - prevent calling a getter on target\n*/\nmodule.exports = function (options, source) {\n  var TARGET = options.target;\n  var GLOBAL = options.global;\n  var STATIC = options.stat;\n  var FORCED, target, key, targetProperty, sourceProperty, descriptor;\n  if (GLOBAL) {\n    target = global;\n  } else if (STATIC) {\n    target = global[TARGET] || setGlobal(TARGET, {});\n  } else {\n    target = (global[TARGET] || {}).prototype;\n  }\n  if (target) for (key in source) {\n    sourceProperty = source[key];\n    if (options.noTargetGet) {\n      descriptor = getOwnPropertyDescriptor(target, key);\n      targetProperty = descriptor && descriptor.value;\n    } else targetProperty = target[key];\n    FORCED = isForced(GLOBAL ? key : TARGET + (STATIC ? '.' : '#') + key, options.forced);\n    // contained in target\n    if (!FORCED && targetProperty !== undefined) {\n      if (typeof sourceProperty === typeof targetProperty) continue;\n      copyConstructorProperties(sourceProperty, targetProperty);\n    }\n    // add a flag to not completely full polyfills\n    if (options.sham || (targetProperty && targetProperty.sham)) {\n      createNonEnumerableProperty(sourceProperty, 'sham', true);\n    }\n    // extend global\n    redefine(target, key, sourceProperty, options);\n  }\n};\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","'use strict';\nvar nativePropertyIsEnumerable = {}.propertyIsEnumerable;\nvar getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\n// Nashorn ~ JDK8 bug\nvar NASHORN_BUG = getOwnPropertyDescriptor && !nativePropertyIsEnumerable.call({ 1: 2 }, 1);\n\n// `Object.prototype.propertyIsEnumerable` method implementation\n// https://tc39.github.io/ecma262/#sec-object.prototype.propertyisenumerable\nexports.f = NASHORN_BUG ? function propertyIsEnumerable(V) {\n  var descriptor = getOwnPropertyDescriptor(this, V);\n  return !!descriptor && descriptor.enumerable;\n} : nativePropertyIsEnumerable;\n","var global = require('../internals/global');\nvar shared = require('../internals/shared');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar has = require('../internals/has');\nvar setGlobal = require('../internals/set-global');\nvar nativeFunctionToString = require('../internals/function-to-string');\nvar InternalStateModule = require('../internals/internal-state');\n\nvar getInternalState = InternalStateModule.get;\nvar enforceInternalState = InternalStateModule.enforce;\nvar TEMPLATE = String(nativeFunctionToString).split('toString');\n\nshared('inspectSource', function (it) {\n  return nativeFunctionToString.call(it);\n});\n\n(module.exports = function (O, key, value, options) {\n  var unsafe = options ? !!options.unsafe : false;\n  var simple = options ? !!options.enumerable : false;\n  var noTargetGet = options ? !!options.noTargetGet : false;\n  if (typeof value == 'function') {\n    if (typeof key == 'string' && !has(value, 'name')) createNonEnumerableProperty(value, 'name', key);\n    enforceInternalState(value).source = TEMPLATE.join(typeof key == 'string' ? key : '');\n  }\n  if (O === global) {\n    if (simple) O[key] = value;\n    else setGlobal(key, value);\n    return;\n  } else if (!unsafe) {\n    delete O[key];\n  } else if (!noTargetGet && O[key]) {\n    simple = true;\n  }\n  if (simple) O[key] = value;\n  else createNonEnumerableProperty(O, key, value);\n// add fake Function#toString for correct work wrapped methods / constructors with methods like LoDash isNative\n})(Function.prototype, 'toString', function toString() {\n  return typeof this == 'function' && getInternalState(this).source || nativeFunctionToString.call(this);\n});\n","module.exports = false;\n","var global = require('../internals/global');\nvar setGlobal = require('../internals/set-global');\n\nvar SHARED = '__core-js_shared__';\nvar store = global[SHARED] || setGlobal(SHARED, {});\n\nmodule.exports = store;\n","var NATIVE_WEAK_MAP = require('../internals/native-weak-map');\nvar global = require('../internals/global');\nvar isObject = require('../internals/is-object');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar objectHas = require('../internals/has');\nvar sharedKey = require('../internals/shared-key');\nvar hiddenKeys = require('../internals/hidden-keys');\n\nvar WeakMap = global.WeakMap;\nvar set, get, has;\n\nvar enforce = function (it) {\n  return has(it) ? get(it) : set(it, {});\n};\n\nvar getterFor = function (TYPE) {\n  return function (it) {\n    var state;\n    if (!isObject(it) || (state = get(it)).type !== TYPE) {\n      throw TypeError('Incompatible receiver, ' + TYPE + ' required');\n    } return state;\n  };\n};\n\nif (NATIVE_WEAK_MAP) {\n  var store = new WeakMap();\n  var wmget = store.get;\n  var wmhas = store.has;\n  var wmset = store.set;\n  set = function (it, metadata) {\n    wmset.call(store, it, metadata);\n    return metadata;\n  };\n  get = function (it) {\n    return wmget.call(store, it) || {};\n  };\n  has = function (it) {\n    return wmhas.call(store, it);\n  };\n} else {\n  var STATE = sharedKey('state');\n  hiddenKeys[STATE] = true;\n  set = function (it, metadata) {\n    createNonEnumerableProperty(it, STATE, metadata);\n    return metadata;\n  };\n  get = function (it) {\n    return objectHas(it, STATE) ? it[STATE] : {};\n  };\n  has = function (it) {\n    return objectHas(it, STATE);\n  };\n}\n\nmodule.exports = {\n  set: set,\n  get: get,\n  has: has,\n  enforce: enforce,\n  getterFor: getterFor\n};\n","var global = require('../internals/global');\nvar nativeFunctionToString = require('../internals/function-to-string');\n\nvar WeakMap = global.WeakMap;\n\nmodule.exports = typeof WeakMap === 'function' && /native code/.test(nativeFunctionToString.call(WeakMap));\n","var has = require('../internals/has');\nvar ownKeys = require('../internals/own-keys');\nvar getOwnPropertyDescriptorModule = require('../internals/object-get-own-property-descriptor');\nvar definePropertyModule = require('../internals/object-define-property');\n\nmodule.exports = function (target, source) {\n  var keys = ownKeys(source);\n  var defineProperty = definePropertyModule.f;\n  var getOwnPropertyDescriptor = getOwnPropertyDescriptorModule.f;\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    if (!has(target, key)) defineProperty(target, key, getOwnPropertyDescriptor(source, key));\n  }\n};\n","var getBuiltIn = require('../internals/get-built-in');\nvar getOwnPropertyNamesModule = require('../internals/object-get-own-property-names');\nvar getOwnPropertySymbolsModule = require('../internals/object-get-own-property-symbols');\nvar anObject = require('../internals/an-object');\n\n// all object keys, includes non-enumerable and symbols\nmodule.exports = getBuiltIn('Reflect', 'ownKeys') || function ownKeys(it) {\n  var keys = getOwnPropertyNamesModule.f(anObject(it));\n  var getOwnPropertySymbols = getOwnPropertySymbolsModule.f;\n  return getOwnPropertySymbols ? keys.concat(getOwnPropertySymbols(it)) : keys;\n};\n","module.exports = require('../internals/global');\n","var internalObjectKeys = require('../internals/object-keys-internal');\nvar enumBugKeys = require('../internals/enum-bug-keys');\n\nvar hiddenKeys = enumBugKeys.concat('length', 'prototype');\n\n// `Object.getOwnPropertyNames` method\n// https://tc39.github.io/ecma262/#sec-object.getownpropertynames\nexports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O) {\n  return internalObjectKeys(O, hiddenKeys);\n};\n","var toIndexedObject = require('../internals/to-indexed-object');\nvar toLength = require('../internals/to-length');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\n\n// `Array.prototype.{ indexOf, includes }` methods implementation\nvar createMethod = function (IS_INCLUDES) {\n  return function ($this, el, fromIndex) {\n    var O = toIndexedObject($this);\n    var length = toLength(O.length);\n    var index = toAbsoluteIndex(fromIndex, length);\n    var value;\n    // Array#includes uses SameValueZero equality algorithm\n    // eslint-disable-next-line no-self-compare\n    if (IS_INCLUDES && el != el) while (length > index) {\n      value = O[index++];\n      // eslint-disable-next-line no-self-compare\n      if (value != value) return true;\n    // Array#indexOf ignores holes, Array#includes - not\n    } else for (;length > index; index++) {\n      if ((IS_INCLUDES || index in O) && O[index] === el) return IS_INCLUDES || index || 0;\n    } return !IS_INCLUDES && -1;\n  };\n};\n\nmodule.exports = {\n  // `Array.prototype.includes` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.includes\n  includes: createMethod(true),\n  // `Array.prototype.indexOf` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.indexof\n  indexOf: createMethod(false)\n};\n","var toInteger = require('../internals/to-integer');\n\nvar max = Math.max;\nvar min = Math.min;\n\n// Helper for a popular repeating case of the spec:\n// Let integer be ? ToInteger(index).\n// If integer < 0, let result be max((length + integer), 0); else let result be min(length, length).\nmodule.exports = function (index, length) {\n  var integer = toInteger(index);\n  return integer < 0 ? max(integer + length, 0) : min(integer, length);\n};\n","exports.f = Object.getOwnPropertySymbols;\n","var fails = require('../internals/fails');\n\nvar replacement = /#|\\.prototype\\./;\n\nvar isForced = function (feature, detection) {\n  var value = data[normalize(feature)];\n  return value == POLYFILL ? true\n    : value == NATIVE ? false\n    : typeof detection == 'function' ? fails(detection)\n    : !!detection;\n};\n\nvar normalize = isForced.normalize = function (string) {\n  return String(string).replace(replacement, '.').toLowerCase();\n};\n\nvar data = isForced.data = {};\nvar NATIVE = isForced.NATIVE = 'N';\nvar POLYFILL = isForced.POLYFILL = 'P';\n\nmodule.exports = isForced;\n","var bind = require('../internals/bind-context');\nvar IndexedObject = require('../internals/indexed-object');\nvar toObject = require('../internals/to-object');\nvar toLength = require('../internals/to-length');\nvar arraySpeciesCreate = require('../internals/array-species-create');\n\nvar push = [].push;\n\n// `Array.prototype.{ forEach, map, filter, some, every, find, findIndex }` methods implementation\nvar createMethod = function (TYPE) {\n  var IS_MAP = TYPE == 1;\n  var IS_FILTER = TYPE == 2;\n  var IS_SOME = TYPE == 3;\n  var IS_EVERY = TYPE == 4;\n  var IS_FIND_INDEX = TYPE == 6;\n  var NO_HOLES = TYPE == 5 || IS_FIND_INDEX;\n  return function ($this, callbackfn, that, specificCreate) {\n    var O = toObject($this);\n    var self = IndexedObject(O);\n    var boundFunction = bind(callbackfn, that, 3);\n    var length = toLength(self.length);\n    var index = 0;\n    var create = specificCreate || arraySpeciesCreate;\n    var target = IS_MAP ? create($this, length) : IS_FILTER ? create($this, 0) : undefined;\n    var value, result;\n    for (;length > index; index++) if (NO_HOLES || index in self) {\n      value = self[index];\n      result = boundFunction(value, index, O);\n      if (TYPE) {\n        if (IS_MAP) target[index] = result; // map\n        else if (result) switch (TYPE) {\n          case 3: return true;              // some\n          case 5: return value;             // find\n          case 6: return index;             // findIndex\n          case 2: push.call(target, value); // filter\n        } else if (IS_EVERY) return false;  // every\n      }\n    }\n    return IS_FIND_INDEX ? -1 : IS_SOME || IS_EVERY ? IS_EVERY : target;\n  };\n};\n\nmodule.exports = {\n  // `Array.prototype.forEach` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.foreach\n  forEach: createMethod(0),\n  // `Array.prototype.map` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.map\n  map: createMethod(1),\n  // `Array.prototype.filter` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.filter\n  filter: createMethod(2),\n  // `Array.prototype.some` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.some\n  some: createMethod(3),\n  // `Array.prototype.every` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.every\n  every: createMethod(4),\n  // `Array.prototype.find` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.find\n  find: createMethod(5),\n  // `Array.prototype.findIndex` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.findIndex\n  findIndex: createMethod(6)\n};\n","var aFunction = require('../internals/a-function');\n\n// optional / simple context binding\nmodule.exports = function (fn, that, length) {\n  aFunction(fn);\n  if (that === undefined) return fn;\n  switch (length) {\n    case 0: return function () {\n      return fn.call(that);\n    };\n    case 1: return function (a) {\n      return fn.call(that, a);\n    };\n    case 2: return function (a, b) {\n      return fn.call(that, a, b);\n    };\n    case 3: return function (a, b, c) {\n      return fn.call(that, a, b, c);\n    };\n  }\n  return function (/* ...args */) {\n    return fn.apply(that, arguments);\n  };\n};\n","module.exports = function (it) {\n  if (typeof it != 'function') {\n    throw TypeError(String(it) + ' is not a function');\n  } return it;\n};\n","var requireObjectCoercible = require('../internals/require-object-coercible');\n\n// `ToObject` abstract operation\n// https://tc39.github.io/ecma262/#sec-toobject\nmodule.exports = function (argument) {\n  return Object(requireObjectCoercible(argument));\n};\n","var isObject = require('../internals/is-object');\nvar isArray = require('../internals/is-array');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar SPECIES = wellKnownSymbol('species');\n\n// `ArraySpeciesCreate` abstract operation\n// https://tc39.github.io/ecma262/#sec-arrayspeciescreate\nmodule.exports = function (originalArray, length) {\n  var C;\n  if (isArray(originalArray)) {\n    C = originalArray.constructor;\n    // cross-realm fallback\n    if (typeof C == 'function' && (C === Array || isArray(C.prototype))) C = undefined;\n    else if (isObject(C)) {\n      C = C[SPECIES];\n      if (C === null) C = undefined;\n    }\n  } return new (C === undefined ? Array : C)(length === 0 ? 0 : length);\n};\n","var classof = require('../internals/classof-raw');\n\n// `IsArray` abstract operation\n// https://tc39.github.io/ecma262/#sec-isarray\nmodule.exports = Array.isArray || function isArray(arg) {\n  return classof(arg) == 'Array';\n};\n","var fails = require('../internals/fails');\n\nmodule.exports = !!Object.getOwnPropertySymbols && !fails(function () {\n  // Chrome 38 Symbol has incorrect toString conversion\n  // eslint-disable-next-line no-undef\n  return !String(Symbol());\n});\n","var wellKnownSymbol = require('../internals/well-known-symbol');\nvar create = require('../internals/object-create');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\n\nvar UNSCOPABLES = wellKnownSymbol('unscopables');\nvar ArrayPrototype = Array.prototype;\n\n// Array.prototype[@@unscopables]\n// https://tc39.github.io/ecma262/#sec-array.prototype-@@unscopables\nif (ArrayPrototype[UNSCOPABLES] == undefined) {\n  createNonEnumerableProperty(ArrayPrototype, UNSCOPABLES, create(null));\n}\n\n// add a key to Array.prototype[@@unscopables]\nmodule.exports = function (key) {\n  ArrayPrototype[UNSCOPABLES][key] = true;\n};\n","var anObject = require('../internals/an-object');\nvar defineProperties = require('../internals/object-define-properties');\nvar enumBugKeys = require('../internals/enum-bug-keys');\nvar hiddenKeys = require('../internals/hidden-keys');\nvar html = require('../internals/html');\nvar documentCreateElement = require('../internals/document-create-element');\nvar sharedKey = require('../internals/shared-key');\nvar IE_PROTO = sharedKey('IE_PROTO');\n\nvar PROTOTYPE = 'prototype';\nvar Empty = function () { /* empty */ };\n\n// Create object with fake `null` prototype: use iframe Object with cleared prototype\nvar createDict = function () {\n  // Thrash, waste and sodomy: IE GC bug\n  var iframe = documentCreateElement('iframe');\n  var length = enumBugKeys.length;\n  var lt = '<';\n  var script = 'script';\n  var gt = '>';\n  var js = 'java' + script + ':';\n  var iframeDocument;\n  iframe.style.display = 'none';\n  html.appendChild(iframe);\n  iframe.src = String(js);\n  iframeDocument = iframe.contentWindow.document;\n  iframeDocument.open();\n  iframeDocument.write(lt + script + gt + 'document.F=Object' + lt + '/' + script + gt);\n  iframeDocument.close();\n  createDict = iframeDocument.F;\n  while (length--) delete createDict[PROTOTYPE][enumBugKeys[length]];\n  return createDict();\n};\n\n// `Object.create` method\n// https://tc39.github.io/ecma262/#sec-object.create\nmodule.exports = Object.create || function create(O, Properties) {\n  var result;\n  if (O !== null) {\n    Empty[PROTOTYPE] = anObject(O);\n    result = new Empty();\n    Empty[PROTOTYPE] = null;\n    // add \"__proto__\" for Object.getPrototypeOf polyfill\n    result[IE_PROTO] = O;\n  } else result = createDict();\n  return Properties === undefined ? result : defineProperties(result, Properties);\n};\n\nhiddenKeys[IE_PROTO] = true;\n","var DESCRIPTORS = require('../internals/descriptors');\nvar definePropertyModule = require('../internals/object-define-property');\nvar anObject = require('../internals/an-object');\nvar objectKeys = require('../internals/object-keys');\n\n// `Object.defineProperties` method\n// https://tc39.github.io/ecma262/#sec-object.defineproperties\nmodule.exports = DESCRIPTORS ? Object.defineProperties : function defineProperties(O, Properties) {\n  anObject(O);\n  var keys = objectKeys(Properties);\n  var length = keys.length;\n  var index = 0;\n  var key;\n  while (length > index) definePropertyModule.f(O, key = keys[index++], Properties[key]);\n  return O;\n};\n","var internalObjectKeys = require('../internals/object-keys-internal');\nvar enumBugKeys = require('../internals/enum-bug-keys');\n\n// `Object.keys` method\n// https://tc39.github.io/ecma262/#sec-object.keys\nmodule.exports = Object.keys || function keys(O) {\n  return internalObjectKeys(O, enumBugKeys);\n};\n","var getBuiltIn = require('../internals/get-built-in');\n\nmodule.exports = getBuiltIn('document', 'documentElement');\n","import {\r\n    IDomStyle, DomType, IDomTable, IDomStyleValues, IDomNumbering, IDomRun,\r\n    IDomHyperlink, IDomImage, OpenXmlElement, IDomTableColumn, IDomTableCell,\r\n    IDomRelationship, IDomSubStyle, IDomTableRow, NumberingPicBullet, DocxTab, DomRelationshipType\r\n} from './dom/dom';\r\nimport * as utils from './utils';\r\nimport { SectionProperties, DocumentElement } from './dom/document';\r\nimport { namespaces, Columns, CommonProperties } from './dom/common';\r\nimport { forEachElementNS, getAttributeLengthValue, getAttributeIntValue, getAttributeBoolValue, getAttributeColorValue, LengthUsage } from './parser/common';\r\nimport { ParagraphElement, ParagraphProperties } from './dom/paragraph';\r\n\r\nexport var autos = {\r\n    shd: \"white\",\r\n    color: \"black\",\r\n    highlight: \"transparent\"\r\n};\r\n\r\nexport class DocumentParser {\r\n    // removes XML declaration \r\n    skipDeclaration: boolean = true;\r\n\r\n    // ignores page and table sizes\r\n    ignoreWidth: boolean = false;\r\n    debug: boolean = false;\r\n\r\n    parseDocumentRelationsFile(xmlString: string) {\r\n        var xrels = xml.parse(xmlString, this.skipDeclaration);\r\n\r\n        return xml.elements(xrels).map(c => <IDomRelationship>{\r\n            id: xml.stringAttr(c, \"Id\"),\r\n            type: values.valueOfRelType(c),\r\n            target: xml.stringAttr(c, \"Target\"),\r\n        });\r\n    }\r\n\r\n    parseDocumentFile(xmlString: string) {\r\n        var result: DocumentElement = {\r\n            domType: DomType.Document,\r\n            children: [],\r\n            style: {},\r\n            props: null\r\n        };\r\n\r\n        var xbody = xml.byTagName(xml.parse(xmlString, this.skipDeclaration), \"body\");\r\n\r\n        xml.foreach(xbody, elem => {\r\n            switch (elem.localName) {\r\n                case \"p\":\r\n                    result.children.push(this.parseParagraph(elem));\r\n                    break;\r\n\r\n                case \"tbl\":\r\n                    result.children.push(this.parseTable(elem));\r\n                    break;\r\n\r\n                case \"sectPr\":\r\n                    result.props = this.parseSectionProperties(elem);\r\n                    break;\r\n            }\r\n        });\r\n\r\n        return result;\r\n    }\r\n\r\n    parseStylesFile(xmlString: string): IDomStyle[] {\r\n        var result = [];\r\n\r\n        var xstyles = xml.parse(xmlString, this.skipDeclaration);\r\n\r\n        xml.foreach(xstyles, n => {\r\n            switch (n.localName) {\r\n                case \"style\":\r\n                    result.push(this.parseStyle(n));\r\n                    break;\r\n\r\n                case \"docDefaults\":\r\n                    result.push(this.parseDefaultStyles(n));\r\n                    break;\r\n            }\r\n        });\r\n\r\n        return result;\r\n    }\r\n\r\n    parseDefaultStyles(node: Element): IDomStyle {\r\n        var result = {\r\n            id: null,\r\n            name: null,\r\n            target: null,\r\n            basedOn: null,\r\n            styles: []\r\n        };\r\n\r\n        xml.foreach(node, c => {\r\n            switch (c.localName) {\r\n                case \"rPrDefault\":\r\n                    var rPr = xml.byTagName(c, \"rPr\");\r\n\r\n                    if (rPr)\r\n                        result.styles.push({\r\n                            target: \"span\",\r\n                            values: this.parseDefaultProperties(rPr, {})\r\n                        });\r\n                    break;\r\n\r\n                case \"pPrDefault\":\r\n                    var pPr = xml.byTagName(c, \"pPr\");\r\n\r\n                    if (pPr)\r\n                        result.styles.push({\r\n                            target: \"p\",\r\n                            values: this.parseDefaultProperties(pPr, {})\r\n                        });\r\n                    break;\r\n            }\r\n        });\r\n\r\n        return result;\r\n    }\r\n\r\n    parseCommonProperties(elem: Element, props: CommonProperties) {\r\n        if(elem.namespaceURI != namespaces.wordml)\r\n            return;\r\n\r\n        switch(elem.localName) {\r\n            case \"color\": \r\n                props.color = getAttributeColorValue(elem, elem.namespaceURI, \"val\");\r\n                break;\r\n\r\n            case \"sz\":\r\n                props.fontSize = getAttributeLengthValue(elem, elem.namespaceURI, \"val\", LengthUsage.FontSize);\r\n                break;\r\n        }\r\n    }\r\n\r\n    parseStyle(node: Element): IDomStyle {\r\n        var result = <IDomStyle>{\r\n            id: xml.className(node, \"styleId\"),\r\n            isDefault: xml.boolAttr(node, \"default\"),\r\n            name: null,\r\n            target: null,\r\n            basedOn: null,\r\n            styles: [],\r\n            linked: null\r\n        };\r\n\r\n        switch (xml.stringAttr(node, \"type\")) {\r\n            case \"paragraph\": result.target = \"p\"; break;\r\n            case \"table\": result.target = \"table\"; break;\r\n            case \"character\": result.target = \"span\"; break;\r\n        }\r\n\r\n        xml.foreach(node, n => {\r\n            switch (n.localName) {\r\n                case \"basedOn\":\r\n                    result.basedOn = xml.className(n, \"val\");\r\n                    break;\r\n\r\n                case \"name\":\r\n                    result.name = xml.stringAttr(n, \"val\");\r\n                    break;\r\n\r\n                case \"link\":\r\n                    result.linked = xml.className(n, \"val\");\r\n                    break;\r\n\r\n                case \"aliases\":\r\n                    result.aliases = xml.stringAttr(n, \"val\").split(\",\");\r\n                    break;\r\n\r\n                case \"pPr\":\r\n                    result.styles.push({\r\n                        target: \"p\",\r\n                        values: this.parseDefaultProperties(n, {})\r\n                    });\r\n                    break;\r\n\r\n                case \"rPr\":\r\n                    result.styles.push({\r\n                        target: \"span\",\r\n                        values: this.parseDefaultProperties(n, {})\r\n                    });\r\n                    break;\r\n\r\n                case \"tblPr\":\r\n                case \"tcPr\":\r\n                    result.styles.push({\r\n                        target: \"td\", //TODO: maybe move to processor\r\n                        values: this.parseDefaultProperties(n, {})\r\n                    });\r\n                    break;\r\n\r\n                case \"tblStylePr\":\r\n                    for (let s of this.parseTableStyle(n))\r\n                        result.styles.push(s);\r\n                    break;\r\n\r\n                case \"rsid\":\r\n                case \"qFormat\":\r\n                case \"hidden\":\r\n                case \"semiHidden\":\r\n                case \"unhideWhenUsed\":\r\n                case \"autoRedefine\":\r\n                case \"uiPriority\":\r\n                    //TODO: ignore\r\n                    break;\r\n\r\n                default:\r\n                    this.debug && console.warn(`DOCX: Unknown style element: ${n.localName}`);\r\n            }\r\n        });\r\n\r\n        return result;\r\n    }\r\n\r\n    parseTableStyle(node: Element): IDomSubStyle[] {\r\n        var result = [];\r\n\r\n        var type = xml.stringAttr(node, \"type\");\r\n        var selector = \"\";\r\n\r\n        switch (type) {\r\n            case \"firstRow\": selector = \"tr.first-row td\"; break;\r\n            case \"lastRow\": selector = \"tr.last-row td\"; break;\r\n            case \"firstCol\": selector = \"td.first-col\"; break;\r\n            case \"lastCol\": selector = \"td.last-col\"; break;\r\n            case \"band1Vert\": selector = \"td.odd-col\"; break;\r\n            case \"band2Vert\": selector = \"td.even-col\"; break;\r\n            case \"band1Horz\": selector = \"tr.odd-row\"; break;\r\n            case \"band2Horz\": selector = \"tr.even-row\"; break;\r\n            default: return [];\r\n        }\r\n\r\n        xml.foreach(node, n => {\r\n            switch (n.localName) {\r\n                case \"pPr\":\r\n                    result.push({\r\n                        target: selector + \" p\",\r\n                        values: this.parseDefaultProperties(n, {})\r\n                    });\r\n                    break;\r\n\r\n                case \"rPr\":\r\n                    result.push({\r\n                        target: selector + \" span\",\r\n                        values: this.parseDefaultProperties(n, {})\r\n                    });\r\n                    break;\r\n\r\n                case \"tblPr\":\r\n                case \"tcPr\":\r\n                    result.push({\r\n                        target: selector, //TODO: maybe move to processor\r\n                        values: this.parseDefaultProperties(n, {})\r\n                    });\r\n                    break;\r\n            }\r\n        });\r\n\r\n        return result;\r\n    }\r\n\r\n    parseNumberingFile(xmlString: string): IDomNumbering[] {\r\n        var result = [];\r\n        var xnums = xml.parse(xmlString, this.skipDeclaration);\r\n\r\n        var mapping = {};\r\n        var bullets = [];\r\n\r\n        xml.foreach(xnums, n => {\r\n            switch (n.localName) {\r\n                case \"abstractNum\":\r\n                    this.parseAbstractNumbering(n, bullets)\r\n                        .forEach(x => result.push(x));\r\n                    break;\r\n\r\n                case \"numPicBullet\":\r\n                    bullets.push(this.parseNumberingPicBullet(n));\r\n                    break;\r\n\r\n                case \"num\":\r\n                    var numId = xml.stringAttr(n, \"numId\");\r\n                    var abstractNumId = xml.elementStringAttr(n, \"abstractNumId\", \"val\");\r\n                    mapping[abstractNumId] = numId;\r\n                    break;\r\n            }\r\n        });\r\n\r\n        result.forEach(x => x.id = mapping[x.id]);\r\n\r\n        return result;\r\n    }\r\n\r\n    parseNumberingPicBullet(elem: Element): NumberingPicBullet {\r\n        var pict = xml.byTagName(elem, \"pict\");\r\n        var shape = pict && xml.byTagName(pict, \"shape\");\r\n        var imagedata = shape && xml.byTagName(shape, \"imagedata\");\r\n\r\n        return imagedata ? {\r\n            id: xml.intAttr(elem, \"numPicBulletId\"),\r\n            src: xml.stringAttr(imagedata, \"id\"),\r\n            style: xml.stringAttr(shape, \"style\")\r\n        } : null;\r\n    }\r\n\r\n    parseAbstractNumbering(node: Element, bullets: any[]): IDomNumbering[] {\r\n        var result = [];\r\n        var id = xml.stringAttr(node, \"abstractNumId\");\r\n\r\n        xml.foreach(node, n => {\r\n            switch (n.localName) {\r\n                case \"lvl\":\r\n                    result.push(this.parseNumberingLevel(id, n, bullets));\r\n                    break;\r\n            }\r\n        });\r\n\r\n        return result;\r\n    }\r\n\r\n    parseNumberingLevel(id: string, node: Element, bullets: any[]): IDomNumbering {\r\n        var result: IDomNumbering = {\r\n            id: id,\r\n            level: xml.intAttr(node, \"ilvl\"),\r\n            style: {}\r\n        };\r\n\r\n        xml.foreach(node, n => {\r\n            switch (n.localName) {\r\n                case \"pPr\":\r\n                    this.parseDefaultProperties(n, result.style);\r\n                    break;\r\n\r\n                case \"lvlPicBulletId\":\r\n                    var id = xml.intAttr(n, \"val\");\r\n                    result.bullet = bullets.filter(x => x.id == id)[0];\r\n                    break;\r\n\r\n                case \"lvlText\":\r\n                    result.levelText = xml.stringAttr(n, \"val\");\r\n                    break;\r\n\r\n                case \"numFmt\":\r\n                    result.format = xml.stringAttr(n, \"val\");\r\n                    break;\r\n            }\r\n        });\r\n\r\n        return result;\r\n    }\r\n\r\n    parseSectionProperties(elem: Element): SectionProperties {\r\n        var section = <SectionProperties>{};\r\n\r\n        forEachElementNS(elem, namespaces.wordml, e => {\r\n            switch(e.localName) {\r\n                case \"pgSz\":\r\n                    section.pageSize = {\r\n                        width: getAttributeLengthValue(e, namespaces.wordml, \"w\"),\r\n                        height: getAttributeLengthValue(e, namespaces.wordml, \"h\"),\r\n                        orientation: e.getAttributeNS(namespaces.wordml, \"orient\")\r\n                    }\r\n                    break;\r\n\r\n                case \"pgMar\":\r\n                    section.pageMargins = {\r\n                        left: getAttributeLengthValue(e, namespaces.wordml, \"left\"),\r\n                        right: getAttributeLengthValue(e, namespaces.wordml, \"right\"),\r\n                        top: getAttributeLengthValue(e, namespaces.wordml, \"top\"),\r\n                        bottom: getAttributeLengthValue(e, namespaces.wordml, \"bottom\"),\r\n                        header: getAttributeLengthValue(e, namespaces.wordml, \"header\"),\r\n                        footer: getAttributeLengthValue(e, namespaces.wordml, \"footer\"),\r\n                        gutter: getAttributeLengthValue(e, namespaces.wordml, \"gutter\"),\r\n                    };\r\n                    break;\r\n\r\n                case \"cols\":\r\n                    section.columns = this.parseColumns(e);\r\n                    break;\r\n            }\r\n        });\r\n\r\n        return section;\r\n    }\r\n\r\n    parseColumns(elem: Element): Columns {\r\n        var result = {\r\n            numberOfColumns: getAttributeIntValue(elem, namespaces.wordml, \"num\"),\r\n            space: getAttributeLengthValue(elem, namespaces.wordml, \"space\"),\r\n            separator: getAttributeBoolValue(elem, namespaces.wordml, \"sep\"),\r\n            equalWidth: getAttributeBoolValue(elem, namespaces.wordml, \"equalWidth\", true),\r\n            columns: []\r\n        };\r\n\r\n        forEachElementNS(elem, namespaces.wordml, e => {\r\n            if(e.localName != \"col\")\r\n                return;\r\n\r\n            result.columns.push({\r\n                width: getAttributeLengthValue(elem, namespaces.wordml, \"w\"),\r\n                space: getAttributeLengthValue(elem, namespaces.wordml, \"space\")\r\n            });\r\n        });\r\n\r\n        return result;\r\n    }\r\n\r\n    parseParagraph(node: Element): OpenXmlElement {\r\n        var result = <ParagraphElement>{ domType: DomType.Paragraph, children: [], props: {} };\r\n\r\n        xml.foreach(node, c => {\r\n            switch (c.localName) {\r\n                case \"r\":\r\n                    result.children.push(this.parseRun(c, result));\r\n                    break;\r\n\r\n                case \"hyperlink\":\r\n                    result.children.push(this.parseHyperlink(c, result));\r\n                    break;\r\n\r\n                case \"bookmarkStart\":\r\n                    result.children.push(this.parseBookmark(c));\r\n                    break;\r\n\r\n                case \"pPr\":\r\n                    this.parseParagraphProperties(c, result);\r\n                    this.parseCommonProperties(c, result.props);\r\n                    break;\r\n            }\r\n        });\r\n\r\n        return result;\r\n    }\r\n\r\n    parseParagraphProperties(elem: Element, paragraph: ParagraphElement) {\r\n        this.parseDefaultProperties(elem, paragraph.style = {}, null, c => {\r\n            switch (c.localName) {\r\n                case \"pStyle\":\r\n                    utils.addElementClass(paragraph, xml.className(c, \"val\"));\r\n                    break;\r\n\r\n                case \"cnfStyle\":\r\n                    utils.addElementClass(paragraph, values.classNameOfCnfStyle(c));\r\n                    break;\r\n                \r\n                case \"sectPr\":\r\n                    paragraph.props.sectionProps = this.parseSectionProperties(c);\r\n                    break;\r\n\r\n                case \"numPr\":\r\n                    this.parseNumbering(c, paragraph);\r\n                    break;\r\n\r\n                case \"framePr\":\r\n                    this.parseFrame(c, paragraph);\r\n                    break;\r\n\r\n                case \"tabs\":\r\n                    this.parseTabs(c, paragraph);\r\n                    break;\r\n\r\n                case \"rPr\":\r\n                    //TODO ignore\r\n                    break;\r\n\r\n                default:\r\n                    return false;\r\n            }\r\n\r\n            return true;\r\n        });\r\n    }\r\n\r\n    parseNumbering(node: Element, paragraph: ParagraphElement) {\r\n        xml.foreach(node, c => {\r\n            switch (c.localName) {\r\n                case \"numId\":\r\n                    paragraph.numberingId = xml.stringAttr(c, \"val\");\r\n                    break;\r\n\r\n                case \"ilvl\":\r\n                    paragraph.numberingLevel = xml.intAttr(c, \"val\");\r\n                    break;\r\n            }\r\n        });\r\n    }\r\n\r\n    parseFrame(node: Element, paragraph: ParagraphElement) {\r\n        var dropCap = xml.stringAttr(node, \"dropCap\");\r\n\r\n        if (dropCap == \"drop\")\r\n            paragraph.style[\"float\"] = \"left\";\r\n    }\r\n\r\n    parseBookmark(node: Element): OpenXmlElement {\r\n        var result: IDomRun = { domType: DomType.Run };\r\n\r\n        result.id = xml.stringAttr(node, \"name\");\r\n\r\n        return result;\r\n    }\r\n\r\n    parseHyperlink(node: Element, parent?: OpenXmlElement): IDomRun {\r\n        var result: IDomHyperlink = { domType: DomType.Hyperlink, parent: parent, children: [] };\r\n        var anchor = xml.stringAttr(node, \"anchor\");\r\n\r\n        if (anchor)\r\n            result.href = \"#\" + anchor;\r\n\r\n        xml.foreach(node, c => {\r\n            switch (c.localName) {\r\n                case \"r\":\r\n                    result.children.push(this.parseRun(c, result));\r\n                    break;\r\n            }\r\n        });\r\n\r\n        return result;\r\n    }\r\n\r\n    parseRun(node: Element, parent?: OpenXmlElement): IDomRun {\r\n        var result: IDomRun = { domType: DomType.Run, parent: parent };\r\n\r\n        xml.foreach(node, c => {\r\n            switch (c.localName) {\r\n                case \"t\":\r\n                    result.text = c.textContent;//.replace(\" \", \"\\u00A0\"); // TODO\r\n                    break;\r\n\r\n                case \"br\":\r\n                    result.break = xml.stringAttr(c, \"type\") || \"textWrapping\";\r\n                    break;\r\n\r\n                case \"tab\":\r\n                    result.tab = true;\r\n                    //result.text = \"\\u00A0\\u00A0\\u00A0\\u00A0\";  // TODO\r\n                    break;\r\n\r\n                case \"drawing\":\r\n                    let d = this.parseDrawing(c);\r\n\r\n                    if (d)\r\n                        result.children = [d];\r\n                    break;\r\n\r\n                case \"rPr\":\r\n                    this.parseRunProperties(c, result);\r\n                    break;\r\n            }\r\n        });\r\n\r\n        return result;\r\n    }\r\n\r\n    parseRunProperties(elem: Element, run: IDomRun) {\r\n        this.parseDefaultProperties(elem, run.style = {}, null, c => {\r\n            switch (c.localName) {\r\n                case \"rStyle\":\r\n                    run.className = xml.className(c, \"val\");\r\n                    break;\r\n\r\n                case \"vertAlign\":\r\n                    switch (xml.stringAttr(c, \"val\")) {\r\n                        case \"subscript\": run.wrapper = \"sub\"; break;\r\n                        case \"superscript\": run.wrapper = \"sup\"; break;\r\n                    }\r\n                    break;\r\n\r\n                default:\r\n                    return false;\r\n            }\r\n\r\n            return true;\r\n        });\r\n    }\r\n\r\n    parseDrawing(node: Element): OpenXmlElement {\r\n        for (var n of xml.elements(node)) {\r\n            switch (n.localName) {\r\n                case \"inline\":\r\n                case \"anchor\":\r\n                    return this.parseDrawingWrapper(n);\r\n            }\r\n        }\r\n    }\r\n\r\n    parseDrawingWrapper(node: Element): OpenXmlElement {\r\n        var result = <OpenXmlElement>{ domType: DomType.Drawing, children: [], style: {} };\r\n        var isAnchor = node.localName == \"anchor\";\r\n\r\n        //TODO\r\n        // result.style[\"margin-left\"] = xml.sizeAttr(node, \"distL\", SizeType.Emu);\r\n        // result.style[\"margin-top\"] = xml.sizeAttr(node, \"distT\", SizeType.Emu);\r\n        // result.style[\"margin-right\"] = xml.sizeAttr(node, \"distR\", SizeType.Emu);\r\n        // result.style[\"margin-bottom\"] = xml.sizeAttr(node, \"distB\", SizeType.Emu);\r\n\r\n        let wrapType: \"wrapTopAndBottom\" | \"wrapNone\" | null = null; \r\n        let simplePos = xml.boolAttr(node, \"simplePos\");\r\n\r\n        let posX = { relative: \"page\", align: \"left\", offset: \"0\" };\r\n        let posY = { relative: \"page\", align: \"top\", offset: \"0\" };\r\n\r\n        for (var n of xml.elements(node)) {\r\n            switch (n.localName) {\r\n                case \"simplePos\":\r\n                    if (simplePos) {\r\n                        posX.offset = xml.sizeAttr(n, \"x\", SizeType.Emu);\r\n                        posY.offset = xml.sizeAttr(n, \"y\", SizeType.Emu);\r\n                    }\r\n                    break;\r\n\r\n                case \"extent\":\r\n                    result.style[\"width\"] = xml.sizeAttr(n, \"cx\", SizeType.Emu);\r\n                    result.style[\"height\"] = xml.sizeAttr(n, \"cy\", SizeType.Emu);\r\n                    break;\r\n\r\n                case \"positionH\":\r\n                case \"positionV\":\r\n                    if (!simplePos) {\r\n                        let pos = n.localName == \"positionH\" ? posX : posY;\r\n                        var alignNode = xml.byTagName(n, \"align\");\r\n                        var offsetNode = xml.byTagName(n, \"posOffset\");\r\n\r\n                        if (alignNode)\r\n                            pos.align = alignNode.textContent;\r\n\r\n                        if (offsetNode)\r\n                            pos.offset = xml.sizeValue(offsetNode, SizeType.Emu);\r\n                    }\r\n                    break;\r\n\r\n                case \"wrapTopAndBottom\":\r\n                    wrapType = \"wrapTopAndBottom\";\r\n                    break;\r\n                \r\n                case \"wrapNone\":\r\n                    wrapType = \"wrapNone\";\r\n                    break;\r\n\r\n                case \"graphic\":\r\n                    var g = this.parseGraphic(n);\r\n\r\n                    if (g)\r\n                        result.children.push(g);\r\n                    break;\r\n            }\r\n        }\r\n\r\n        if (wrapType == \"wrapTopAndBottom\") {\r\n            result.style['display'] = 'block';\r\n\r\n            if (posX.align) {\r\n                result.style['text-align'] = posX.align;\r\n                result.style['width'] = \"100%\";\r\n            }\r\n        }\r\n        else if(wrapType == \"wrapNone\") {\r\n            result.style['display'] = 'block';\r\n            result.style['position'] = 'relative';\r\n            result.style[\"width\"] = \"0px\";\r\n            result.style[\"height\"] = \"0px\";\r\n\r\n            if(posX.offset)\r\n                result.style[\"left\"] = posX.offset;\r\n            if(posY.offset)\r\n                result.style[\"top\"] = posY.offset;\r\n        }\r\n        else if (isAnchor && (posX.align == 'left' || posX.align == 'right')) {\r\n            result.style[\"float\"] = posX.align;\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    parseGraphic(elem: Element): OpenXmlElement {\r\n        var graphicData = xml.byTagName(elem, \"graphicData\");\r\n\r\n        for (let n of xml.elements(graphicData)) {\r\n            switch (n.localName) {\r\n                case \"pic\":\r\n                    return this.parsePicture(n);\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    parsePicture(elem: Element): IDomImage {\r\n        var result = <IDomImage>{ domType: DomType.Image, src: \"\", style: {} };\r\n        var blipFill = xml.byTagName(elem, \"blipFill\");\r\n        var blip = xml.byTagName(blipFill, \"blip\");\r\n\r\n        result.src = xml.stringAttr(blip, \"embed\");\r\n\r\n        var spPr = xml.byTagName(elem, \"spPr\");\r\n        var xfrm = xml.byTagName(spPr, \"xfrm\");\r\n\r\n        result.style[\"position\"] = \"relative\";\r\n\r\n        for (var n of xml.elements(xfrm)) {\r\n            switch (n.localName) {\r\n                case \"ext\":\r\n                    result.style[\"width\"] = xml.sizeAttr(n, \"cx\", SizeType.Emu);\r\n                    result.style[\"height\"] = xml.sizeAttr(n, \"cy\", SizeType.Emu);\r\n                    break;\r\n\r\n                case \"off\":\r\n                    result.style[\"left\"] = xml.sizeAttr(n, \"x\", SizeType.Emu);\r\n                    result.style[\"top\"] = xml.sizeAttr(n, \"y\", SizeType.Emu);\r\n                    break;\r\n            }\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    parseTable(node: Element): IDomTable {\r\n        var result: IDomTable = { domType: DomType.Table, children: [] };\r\n\r\n        xml.foreach(node, c => {\r\n            switch (c.localName) {\r\n                case \"tr\":\r\n                    result.children.push(this.parseTableRow(c));\r\n                    break;\r\n\r\n                case \"tblGrid\":\r\n                    result.columns = this.parseTableColumns(c);\r\n                    break;\r\n\r\n                case \"tblPr\":\r\n                    this.parseTableProperties(c, result);\r\n                    break;\r\n            }\r\n        });\r\n\r\n        return result;\r\n    }\r\n\r\n    parseTableColumns(node: Element): IDomTableColumn[] {\r\n        var result = [];\r\n\r\n        xml.foreach(node, n => {\r\n            switch (n.localName) {\r\n                case \"gridCol\":\r\n                    result.push({ width: xml.sizeAttr(n, \"w\") });\r\n                    break;\r\n            }\r\n        });\r\n\r\n        return result;\r\n    }\r\n\r\n    parseTableProperties(elem: Element, table: IDomTable) {\r\n        table.style = {};\r\n        table.cellStyle = {};\r\n\r\n        this.parseDefaultProperties(elem, table.style, table.cellStyle, c => {\r\n            switch (c.localName) {\r\n                case \"tblStyle\":\r\n                    table.className = xml.className(c, \"val\");\r\n                    break;\r\n\r\n                case \"tblLook\":\r\n                    utils.addElementClass(table, values.classNameOftblLook(c));\r\n                    break;\r\n\r\n                case \"tblpPr\":\r\n                    this.parseTablePosition(c, table);\r\n                    break;\r\n\r\n                default:\r\n                    return false;\r\n            }\r\n\r\n            return true;\r\n        });\r\n\r\n        switch (table.style[\"text-align\"]) {\r\n            case \"center\":\r\n                delete table.style[\"text-align\"];\r\n                table.style[\"margin-left\"] = \"auto\";\r\n                table.style[\"margin-right\"] = \"auto\";\r\n                break;\r\n\r\n            case \"right\":\r\n                delete table.style[\"text-align\"];\r\n                table.style[\"margin-left\"] = \"auto\";\r\n                break;\r\n        }\r\n    }\r\n\r\n    parseTablePosition(node: Element, table: IDomTable) {\r\n        var vertAnchor = xml.stringAttr(node, \"vertAnchor\");\r\n        var horzAnchor = xml.stringAttr(node, \"horzAnchor\");\r\n        var tblpX = xml.sizeAttr(node, \"tblpX\");\r\n        var tblpY = xml.sizeAttr(node, \"tblpY\");\r\n        var tblpXSpec = xml.stringAttr(node, \"tblpXSpec\");\r\n        var tblpYSpec = xml.stringAttr(node, \"tblpYSpec\");\r\n        var topFromText = xml.sizeAttr(node, \"topFromText\");\r\n        var bottomFromText = xml.sizeAttr(node, \"bottomFromText\");\r\n        var rightFromText = xml.sizeAttr(node, \"rightFromText\");\r\n        var leftFromText = xml.sizeAttr(node, \"leftFromText\");\r\n\r\n        table.style[\"float\"] = 'left';\r\n        table.style[\"margin-bottom\"] = values.addSize(table.style[\"margin-bottom\"], bottomFromText);\r\n        table.style[\"margin-left\"] = values.addSize(table.style[\"margin-left\"], leftFromText);\r\n        table.style[\"margin-right\"] = values.addSize(table.style[\"margin-right\"], rightFromText);\r\n        table.style[\"margin-top\"] = values.addSize(table.style[\"margin-top\"], topFromText);\r\n    }\r\n\r\n    parseTableRow(node: Element): IDomTableRow {\r\n        var result: IDomTableRow = { domType: DomType.Row, children: [] };\r\n\r\n        xml.foreach(node, c => {\r\n            switch (c.localName) {\r\n                case \"tc\":\r\n                    result.children.push(this.parseTableCell(c));\r\n                    break;\r\n\r\n                case \"trPr\":\r\n                    this.parseTableRowProperties(c, result);\r\n                    break;\r\n            }\r\n        });\r\n\r\n        return result;\r\n    }\r\n\r\n    parseTableRowProperties(elem: Element, row: IDomTableRow) {\r\n        row.style = this.parseDefaultProperties(elem, {}, null, c => {\r\n            switch (c.localName) {\r\n                case \"cnfStyle\":\r\n                    row.className = values.classNameOfCnfStyle(c);\r\n                    break;\r\n\r\n                default:\r\n                    return false;\r\n            }\r\n\r\n            return true;\r\n        });\r\n    }\r\n\r\n    parseTableCell(node: Element): OpenXmlElement {\r\n        var result: IDomTableCell = { domType: DomType.Cell, children: [] };\r\n\r\n        xml.foreach(node, c => {\r\n            switch (c.localName) {\r\n                case \"tbl\":\r\n                    result.children.push(this.parseTable(c));\r\n                    break;\r\n\r\n                case \"p\":\r\n                    result.children.push(this.parseParagraph(c));\r\n                    break;\r\n\r\n                case \"tcPr\":\r\n                    this.parseTableCellProperties(c, result);\r\n                    break;\r\n            }\r\n        });\r\n\r\n        return result;\r\n    }\r\n\r\n    parseTableCellProperties(elem: Element, cell: IDomTableCell) {\r\n        cell.style = this.parseDefaultProperties(elem, {}, null, c => {\r\n            switch (c.localName) {\r\n                case \"gridSpan\":\r\n                    cell.span = xml.intAttr(c, \"val\", null);\r\n                    break;\r\n\r\n                case \"vMerge\": //TODO\r\n                    break;\r\n\r\n                case \"cnfStyle\":\r\n                    cell.className = values.classNameOfCnfStyle(c);\r\n                    break;\r\n\r\n                default:\r\n                    return false;\r\n            }\r\n\r\n            return true;\r\n        });\r\n    }\r\n\r\n    parseDefaultProperties(elem: Element, style: IDomStyleValues = null, childStyle: IDomStyleValues = null, handler: (prop: Element) => boolean = null): IDomStyleValues {\r\n        style = style || {};\r\n\r\n        xml.foreach(elem, c => {\r\n            switch (c.localName) {\r\n                case \"jc\":\r\n                    style[\"text-align\"] = values.valueOfJc(c);\r\n                    break;\r\n\r\n                case \"textAlignment\":\r\n                    style[\"vertical-align\"] = values.valueOfTextAlignment(c);\r\n                    break;\r\n\r\n                case \"color\":\r\n                    style[\"color\"] = xml.colorAttr(c, \"val\", null, autos.color);\r\n                    break;\r\n\r\n                case \"sz\":\r\n                    style[\"font-size\"] = xml.sizeAttr(c, \"val\", SizeType.FontSize);\r\n                    break;\r\n\r\n                case \"shd\":\r\n                    style[\"background-color\"] = xml.colorAttr(c, \"fill\", null, autos.shd);\r\n                    break;\r\n\r\n                case \"highlight\":\r\n                    style[\"background-color\"] = xml.colorAttr(c, \"val\", null, autos.highlight);\r\n                    break;\r\n\r\n                case \"tcW\":\r\n                    if (this.ignoreWidth)\r\n                        break;\r\n\r\n                case \"tblW\":\r\n                    style[\"width\"] = values.valueOfSize(c, \"w\");\r\n                    break;\r\n\r\n                case \"trHeight\":\r\n                    this.parseTrHeight(c, style);\r\n                    break;\r\n\r\n                case \"strike\":\r\n                    style[\"text-decoration\"] = values.valueOfStrike(c);\r\n                    break;\r\n\r\n                case \"b\":\r\n                    style[\"font-weight\"] = values.valueOfBold(c);\r\n                    break;\r\n\r\n                case \"i\":\r\n                    style[\"font-style\"] = \"italic\";\r\n                    break;\r\n\r\n                case \"u\":\r\n                    this.parseUnderline(c, style);\r\n                    break;\r\n\r\n                case \"ind\":\r\n                case \"tblInd\":\r\n                    this.parseIndentation(c, style);\r\n                    break;\r\n\r\n                case \"rFonts\":\r\n                    this.parseFont(c, style);\r\n                    break;\r\n\r\n                case \"tblBorders\":\r\n                    this.parseBorderProperties(c, childStyle || style);\r\n                    break;\r\n\r\n                case \"tblCellSpacing\":\r\n                    style[\"border-spacing\"] = values.valueOfMargin(c);\r\n                    style[\"border-collapse\"] = \"separate\";\r\n                    break;\r\n\r\n                case \"pBdr\":\r\n                    this.parseBorderProperties(c, style);\r\n                    break;\r\n\r\n                case \"tcBorders\":\r\n                    this.parseBorderProperties(c, style);\r\n                    break;\r\n\r\n                case \"noWrap\":\r\n                    //TODO\r\n                    //style[\"white-space\"] = \"nowrap\";\r\n                    break;\r\n\r\n                case \"tblCellMar\":\r\n                case \"tcMar\":\r\n                    this.parseMarginProperties(c, childStyle || style);\r\n                    break;\r\n\r\n                case \"tblLayout\":\r\n                    style[\"table-layout\"] = values.valueOfTblLayout(c);\r\n                    break;\r\n\r\n                case \"vAlign\":\r\n                    style[\"vertical-align\"] = xml.stringAttr(c, \"val\");\r\n                    break;\r\n\r\n                case \"spacing\":\r\n                    if (elem.localName == \"pPr\")\r\n                        this.parseSpacing(c, style);\r\n                    break;\r\n\r\n                case \"lang\":\r\n                case \"noProof\": //ignore spellcheck\r\n                case \"webHidden\": // maybe web-hidden should be implemented\r\n                    //TODO ignore\r\n                    break;\r\n\r\n                default:\r\n                    if (handler != null && !handler(c))\r\n                        this.debug && console.warn(`DOCX: Unknown document element: ${c.localName}`);\r\n                    break;\r\n            }\r\n        });\r\n\r\n        return style;\r\n    }\r\n\r\n    parseUnderline(node: Element, style: IDomStyleValues) {\r\n        var val = xml.stringAttr(node, \"val\");\r\n\r\n        if (val == null || val == \"none\")\r\n            return;\r\n\r\n        switch (val) {\r\n            case \"dash\":\r\n            case \"dashDotDotHeavy\":\r\n            case \"dashDotHeavy\":\r\n            case \"dashedHeavy\":\r\n            case \"dashLong\":\r\n            case \"dashLongHeavy\":\r\n            case \"dotDash\":\r\n            case \"dotDotDash\":\r\n                style[\"text-decoration-style\"] = \"dashed\";\r\n                break;\r\n\r\n            case \"dotted\":\r\n            case \"dottedHeavy\":\r\n                style[\"text-decoration-style\"] = \"dotted\";\r\n                break;\r\n\r\n            case \"double\":\r\n                style[\"text-decoration-style\"] = \"double\";\r\n                break;\r\n\r\n            case \"single\":\r\n            case \"thick\":\r\n                style[\"text-decoration\"] = \"underline\";\r\n                break;\r\n\r\n            case \"wave\":\r\n            case \"wavyDouble\":\r\n            case \"wavyHeavy\":\r\n                style[\"text-decoration-style\"] = \"wavy\";\r\n                break;\r\n\r\n            case \"words\":\r\n                style[\"text-decoration\"] = \"underline\";\r\n                break;\r\n        }\r\n\r\n        var col = xml.colorAttr(node, \"color\");\r\n\r\n        if (col)\r\n            style[\"text-decoration-color\"] = col;\r\n    }\r\n\r\n    parseFont(node: Element, style: IDomStyleValues) {\r\n        var ascii = xml.stringAttr(node, \"ascii\");\r\n\r\n        if (ascii)\r\n            style[\"font-family\"] = ascii;\r\n    }\r\n\r\n    parseIndentation(node: Element, style: IDomStyleValues) {\r\n        var firstLine = xml.sizeAttr(node, \"firstLine\");\r\n        var left = xml.sizeAttr(node, \"left\");\r\n        var start = xml.sizeAttr(node, \"start\");\r\n        var right = xml.sizeAttr(node, \"right\");\r\n        var end = xml.sizeAttr(node, \"end\");\r\n\r\n        if (firstLine) style[\"text-indent\"] = firstLine;\r\n        if (left || start) style[\"margin-left\"] = left || start;\r\n        if (right || end) style[\"margin-right\"] = right || end;\r\n    }\r\n\r\n    parseSpacing(node: Element, style: IDomStyleValues) {\r\n        var before = xml.sizeAttr(node, \"before\");\r\n        var after = xml.sizeAttr(node, \"after\");\r\n        var line = xml.intAttr(node, \"line\", null);\r\n        var lineRule = xml.stringAttr(node, \"lineRule\");\r\n\r\n        if (before) style[\"margin-top\"] = before;\r\n        if (after) style[\"margin-bottom\"] = after;\r\n        \r\n        if (line !== null) {\r\n            switch(lineRule) {\r\n                case \"auto\": \r\n                    style[\"line-height\"] = `${(line / 240).toFixed(2)}`;\r\n                    break;\r\n\r\n                case \"atLeast\":\r\n                    style[\"line-height\"] = `calc(100% + ${line / 20}pt)`;\r\n                    break;\r\n\r\n                default:\r\n                    style[\"line-height\"] = style[\"min-height\"] = `${line / 20}pt`\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n\r\n    parseTabs(node: Element, paragraph: ParagraphElement) {\r\n        paragraph.tabs = xml.elements(node, \"tab\").map(n => <DocxTab>{\r\n            position: xml.sizeAttr(n, \"pos\"),\r\n            leader: xml.stringAttr(n, \"leader\"),\r\n            style: xml.stringAttr(n, \"val\"),\r\n        });\r\n    }\r\n\r\n    parseMarginProperties(node: Element, output: IDomStyleValues) {\r\n        xml.foreach(node, c => {\r\n            switch (c.localName) {\r\n                case \"left\":\r\n                    output[\"padding-left\"] = values.valueOfMargin(c);\r\n                    break;\r\n\r\n                case \"right\":\r\n                    output[\"padding-right\"] = values.valueOfMargin(c);\r\n                    break;\r\n\r\n                case \"top\":\r\n                    output[\"padding-top\"] = values.valueOfMargin(c);\r\n                    break;\r\n\r\n                case \"bottom\":\r\n                    output[\"padding-bottom\"] = values.valueOfMargin(c);\r\n                    break;\r\n            }\r\n        });\r\n    }\r\n\r\n    parseTrHeight(node: Element, output: IDomStyleValues) {\r\n        switch (xml.stringAttr(node, \"hRule\")) {\r\n            case \"exact\":\r\n                output[\"height\"] = xml.sizeAttr(node, \"val\");\r\n                break;\r\n\r\n            case \"atLeast\":\r\n            default:\r\n                output[\"height\"] = xml.sizeAttr(node, \"val\");\r\n                // min-height doesn't work for tr\r\n                //output[\"min-height\"] = xml.sizeAttr(node, \"val\");  \r\n                break;\r\n        }\r\n    }\r\n\r\n    parseBorderProperties(node: Element, output: IDomStyleValues) {\r\n        xml.foreach(node, c => {\r\n            switch (c.localName) {\r\n                case \"start\":\r\n                case \"left\":\r\n                    output[\"border-left\"] = values.valueOfBorder(c);\r\n                    break;\r\n\r\n                case \"end\":\r\n                case \"right\":\r\n                    output[\"border-right\"] = values.valueOfBorder(c);\r\n                    break;\r\n\r\n                case \"top\":\r\n                    output[\"border-top\"] = values.valueOfBorder(c);\r\n                    break;\r\n\r\n                case \"bottom\":\r\n                    output[\"border-bottom\"] = values.valueOfBorder(c);\r\n                    break;\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\nenum SizeType {\r\n    FontSize,\r\n    Dxa,\r\n    Emu,\r\n    Border,\r\n    Percent\r\n}\r\n\r\nclass xml {\r\n    static parse(xmlString: string, skipDeclaration: boolean = true): Element {\r\n        if (skipDeclaration)\r\n            xmlString = xmlString.replace(/<[?].*[?]>/, \"\");\r\n\r\n        return <Element>new DOMParser().parseFromString(xmlString, \"application/xml\").firstChild;\r\n    }\r\n\r\n    static elements(node: Element, tagName: string = null): Element[] {\r\n        var result = [];\r\n\r\n        for (var i = 0; i < node.childNodes.length; i++) {\r\n            let n = node.childNodes[i] as Element;\r\n            if (n.nodeType == 1 && (tagName == null || n.localName == tagName))\r\n                result.push(n);\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    static foreach(node: Element, cb: (n: Element) => void) {\r\n        for (var i = 0; i < node.childNodes.length; i++) {\r\n            let n = node.childNodes[i];\r\n\r\n            if (n.nodeType == 1)\r\n                cb(<Element>n);\r\n        }\r\n    }\r\n\r\n    static byTagName(elem: Element, tagName: string): Element {\r\n        for (var i = 0; i < elem.childNodes.length; i++) {\r\n            let n = elem.childNodes[i] as Element;\r\n            if (n.nodeType == 1 && n.localName == tagName)\r\n                return <Element>elem.childNodes[i];\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    static elementStringAttr(elem: Element, nodeName, attrName: string) {\r\n        var n = xml.byTagName(elem, nodeName)\r\n        return n ? xml.stringAttr(n, attrName) : null;\r\n    }\r\n\r\n    static stringAttr(node: Element, attrName: string) {\r\n        var elem = <Element>node;\r\n\r\n        for (var i = 0; i < elem.attributes.length; i++) {\r\n            var attr = elem.attributes.item(i);\r\n\r\n            if (attr.localName == attrName)\r\n                return attr.value;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    static colorAttr(node: Element, attrName: string, defValue: string = null, autoColor: string = 'black') {\r\n        var v = xml.stringAttr(node, attrName);\r\n\r\n        switch (v) {\r\n            case \"yellow\":\r\n                return v;\r\n\r\n            case \"auto\":\r\n                return autoColor;\r\n        }\r\n\r\n        return v ? `#${v}` : defValue;\r\n    }\r\n\r\n    static boolAttr(node: Element, attrName: string, defValue: boolean = false) {\r\n        var v = xml.stringAttr(node, attrName);\r\n\r\n        switch (v) {\r\n            case \"1\": return true;\r\n            case \"0\": return false;\r\n        }\r\n\r\n        return defValue;\r\n    }\r\n\r\n    static intAttr(node: Element, attrName: string, defValue: number = 0) {\r\n        var val = xml.stringAttr(node, attrName);\r\n        return val ? parseInt(xml.stringAttr(node, attrName)) : defValue;\r\n    }\r\n\r\n    static sizeAttr(node: Element, attrName: string, type: SizeType = SizeType.Dxa) {\r\n        return xml.convertSize(xml.stringAttr(node, attrName), type);\r\n    }\r\n\r\n    static sizeValue(node: Element, type: SizeType = SizeType.Dxa) {\r\n        return xml.convertSize(node.textContent, type);\r\n    }\r\n\r\n    static convertSize(val: string, type: SizeType = SizeType.Dxa) {\r\n        if (val == null || val.indexOf(\"pt\") > -1)\r\n            return val;\r\n\r\n        var intVal = parseInt(val);\r\n\r\n        switch (type) {\r\n            case SizeType.Dxa: return (0.05 * intVal).toFixed(2) + \"pt\";\r\n            case SizeType.Emu: return (intVal / 12700).toFixed(2) + \"pt\";\r\n            case SizeType.FontSize: return (0.5 * intVal).toFixed(2) + \"pt\";\r\n            case SizeType.Border: return (0.125 * intVal).toFixed(2) + \"pt\";\r\n            case SizeType.Percent: return (0.02 * intVal).toFixed(2) + \"%\";\r\n        }\r\n\r\n        return val;\r\n    }\r\n\r\n    static className(node: Element, attrName: string) {\r\n        var val = xml.stringAttr(node, attrName);\r\n\r\n        return val && val.replace(/[ .]+/g, '-').replace(/[&]+/g, 'and');\r\n    }\r\n}\r\n\r\nclass values {\r\n    static valueOfBold(c: Element) {\r\n        return xml.boolAttr(c, \"val\", true) ? \"bold\" : \"normal\"\r\n    }\r\n\r\n    static valueOfSize(c: Element, attr: string) {\r\n        var type: SizeType = SizeType.Dxa;\r\n\r\n        switch (xml.stringAttr(c, \"type\")) {\r\n            case \"dxa\": break;\r\n            case \"pct\": type = SizeType.Percent; break;\r\n        }\r\n\r\n        return xml.sizeAttr(c, attr, type);\r\n    }\r\n\r\n    static valueOfStrike(c: Element) {\r\n        return xml.boolAttr(c, \"val\", true) ? \"line-through\" : \"none\"\r\n    }\r\n\r\n    static valueOfMargin(c: Element) {\r\n        return xml.sizeAttr(c, \"w\");\r\n    }\r\n\r\n    static valueOfRelType(c: Element) {\r\n        switch (xml.sizeAttr(c, \"Type\")) {\r\n            case \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings\":\r\n                return DomRelationshipType.Settings;\r\n            case \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme\":\r\n                return DomRelationshipType.Theme;\r\n            case \"http://schemas.microsoft.com/office/2007/relationships/stylesWithEffects\":\r\n                return DomRelationshipType.StylesWithEffects;\r\n            case \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\":\r\n                return DomRelationshipType.Styles;\r\n            case \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable\":\r\n                return DomRelationshipType.FontTable;\r\n            case \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image\":\r\n                return DomRelationshipType.Image;\r\n            case \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/webSettings\":\r\n                return DomRelationshipType.WebSettings;\r\n        }\r\n\r\n        return DomRelationshipType.Unknown;\r\n    }\r\n\r\n    static valueOfBorder(c: Element) {\r\n        var type = xml.stringAttr(c, \"val\");\r\n\r\n        if (type == \"nil\")\r\n            return \"none\";\r\n\r\n        var color = xml.colorAttr(c, \"color\");\r\n        var size = xml.sizeAttr(c, \"sz\", SizeType.Border);\r\n\r\n        return `${size} solid ${color == \"auto\" ? \"black\" : color}`;\r\n    }\r\n\r\n    static valueOfTblLayout(c: Element) {\r\n        var type = xml.stringAttr(c, \"val\");\r\n        return type == \"fixed\" ? \"fixed\" : \"auto\";\r\n    }\r\n\r\n    static classNameOfCnfStyle(c: Element) {\r\n        let className = \"\";\r\n        let val = xml.stringAttr(c, \"val\");\r\n        //FirstRow, LastRow, FirstColumn, LastColumn, Band1Vertical, Band2Vertical, Band1Horizontal, Band2Horizontal, NE Cell, NW Cell, SE Cell, SW Cell.\r\n\r\n        if (val[0] == \"1\") className += \" first-row\";\r\n        if (val[1] == \"1\") className += \" last-row\";\r\n        if (val[2] == \"1\") className += \" first-col\";\r\n        if (val[3] == \"1\") className += \" last-col\";\r\n        if (val[4] == \"1\") className += \" odd-col\";\r\n        if (val[5] == \"1\") className += \" even-col\";\r\n        if (val[6] == \"1\") className += \" odd-row\";\r\n        if (val[7] == \"1\") className += \" even-row\";\r\n        if (val[8] == \"1\") className += \" ne-cell\";\r\n        if (val[9] == \"1\") className += \" nw-cell\";\r\n        if (val[10] == \"1\") className += \" se-cell\";\r\n        if (val[11] == \"1\") className += \" sw-cell\";\r\n\r\n        return className.trim();\r\n    }\r\n\r\n    static valueOfJc(c: Element) {\r\n        var type = xml.stringAttr(c, \"val\");\r\n\r\n        switch (type) {\r\n            case \"start\":\r\n            case \"left\": return \"left\";\r\n            case \"center\": return \"center\";\r\n            case \"end\":\r\n            case \"right\": return \"right\";\r\n            case \"both\": return \"justify\";\r\n        }\r\n\r\n        return type;\r\n    }\r\n\r\n    static valueOfTextAlignment(c: Element) {\r\n        var type = xml.stringAttr(c, \"val\");\r\n\r\n        switch (type) {\r\n            case \"auto\":\r\n            case \"baseline\": return \"baseline\";\r\n            case \"top\": return \"top\";\r\n            case \"center\": return \"middle\";\r\n            case \"bottom\": return \"bottom\";\r\n        }\r\n\r\n        return type;\r\n    }\r\n\r\n    static addSize(a: string, b: string): string {\r\n        if (a == null) return b;\r\n        if (b == null) return a;\r\n\r\n        return `calc(${a} + ${b})`; //TODO\r\n    }\r\n\r\n    static checkMask(num: number, mask: number) {\r\n        return (num & mask) == mask;\r\n    }\r\n\r\n    static classNameOftblLook(c: Element) {\r\n        let className = \"\";\r\n\r\n        if (xml.boolAttr(c, \"firstColumn\")) className += \" first-col\";\r\n        if (xml.boolAttr(c, \"firstRow\")) className += \" first-row\";\r\n        if (xml.boolAttr(c, \"lastColumn\")) className += \" lat-col\";\r\n        if (xml.boolAttr(c, \"lastRow\")) className += \" last-row\";\r\n        if (xml.boolAttr(c, \"noHBand\")) className += \" no-hband\";\r\n        if (xml.boolAttr(c, \"noVBand\")) className += \" no-vband\";\r\n\r\n        return className.trim();\r\n    }\r\n}\r\n","import { OpenXmlElement } from \"./dom/dom\";\r\n\r\nexport function addElementClass(element: OpenXmlElement, className: string): string {\r\n    return element.className = appendClass(element.className, className);\r\n}\r\n\r\nexport function appendClass(classList: string, className: string): string {\r\n    return (!classList) ? className : `${classList} ${className}`\r\n}","export const namespaces = {\r\n    wordml: \"http://schemas.openxmlformats.org/wordprocessingml/2006/main\"\r\n}\r\n\r\nexport interface Length {\r\n    value: number;\r\n    type: \"px\" | \"pt\" | \"%\"\r\n}\r\n\r\nexport interface Font {\r\n    name: string;\r\n    family: string;\r\n}\r\n\r\nexport interface Column {\r\n    space: Length;\r\n    width: Length;\r\n}\r\n\r\nexport interface Columns {\r\n    space: Length;\r\n    numberOfColumns: number;\r\n    separator: boolean;\r\n    equalWidth: boolean;\r\n    columns: Column[];\r\n}\r\n\r\nexport interface CommonProperties {\r\n    fontSize: Length;\r\n    color: string;\r\n}","import { Length } from \"../dom/common\";\r\n\r\nexport function forEachElementNS(elem: Element, namespaceURI: string, callback: (elem: Element) => any) {\r\n    for(let i = 0; i < elem.childNodes.length; i ++) {\r\n        let n = elem.childNodes[i];\r\n\r\n        if(n.nodeType == 1 && n.namespaceURI == namespaceURI)\r\n            callback(<Element>n);\r\n    }\r\n}\r\n\r\nexport function getAttributeIntValue(elem: Element, namespaceURI: string, name: string): number {\r\n    var val = elem.getAttributeNS(namespaceURI, name);\r\n    return val ? parseInt(val) : null;\r\n}\r\n\r\nexport function getAttributeColorValue(elem: Element, namespaceURI: string, name: string): string {\r\n    var val = elem.getAttributeNS(namespaceURI, name);\r\n    return val ? `#${val}` : null;\r\n}\r\n\r\nexport function getAttributeBoolValue(elem: Element, namespaceURI: string, name: string, defaultValue: boolean = false): boolean {\r\n    var val = elem.getAttributeNS(namespaceURI, name);\r\n\r\n    if(val == null)\r\n        return defaultValue;\r\n\r\n    return val === \"true\" || val === \"1\";\r\n}\r\n\r\nexport function getAttributeLengthValue(elem: Element, namespaceURI: string, name: string, usage: LengthUsage = LengthUsage.Dxa): Length {\r\n    return parseLength(elem.getAttributeNS(namespaceURI, name), usage);\r\n}\r\n\r\nexport enum LengthUsage {\r\n    Dxa,\r\n    Emu,\r\n    FontSize,\r\n    Border,\r\n    Percent\r\n}\r\n\r\nexport function parseLength(val: string | null, usage: LengthUsage = LengthUsage.Dxa): Length {\r\n    if (!val)\r\n        return null;\r\n\r\n    var num = parseInt(val);\r\n\r\n    switch (usage) {\r\n        case LengthUsage.Dxa: return { value: 0.05 * num, type: \"pt\" };\r\n        case LengthUsage.Emu: return { value: num / 12700, type: \"pt\" };\r\n        case LengthUsage.FontSize: return { value: 0.5 * num, type: \"pt\" };\r\n        case LengthUsage.Border: return { value: 0.125 * num, type: \"pt\" };\r\n        case LengthUsage.Percent: return { value: 0.02 * num, type: \"%\" };\r\n    }\r\n\r\n    return null;\r\n}","import { Document } from './document';\r\nimport { IDomStyle, DomType, IDomTable, IDomStyleValues, IDomNumbering, IDomRun, \r\n    IDomHyperlink, IDomImage, OpenXmlElement, IDomTableColumn, IDomTableCell } from './dom/dom';\r\nimport { Length, CommonProperties } from './dom/common';\r\nimport { Options } from './docx-preview';\r\nimport { DocumentElement, SectionProperties } from './dom/document';\r\nimport { ParagraphElement } from './dom/paragraph';\r\n\r\nexport class HtmlRenderer {\r\n\r\n    inWrapper: boolean = true;\r\n    className: string = \"docx\";\r\n    document: Document;\r\n    options: Options;\r\n\r\n    private digitTest = /^[0-9]/.test;\r\n\r\n    constructor(public htmlDocument: HTMLDocument) {\r\n    }\r\n\r\n    render(document: Document, bodyContainer: HTMLElement, styleContainer: HTMLElement = null, options: Options) {\r\n        this.document = document;\r\n        this.options = options;\r\n\r\n        styleContainer = styleContainer || bodyContainer;\r\n\r\n        removeAllElements(styleContainer);\r\n        removeAllElements(bodyContainer);\r\n\r\n        appendComment(styleContainer, \"docxjs library predefined styles\");\r\n        styleContainer.appendChild(this.renderDefaultStyle());\r\n        appendComment(styleContainer, \"docx document styles\");\r\n        styleContainer.appendChild(this.renderStyles(document.styles));\r\n\r\n        if (document.numbering) {\r\n            appendComment(styleContainer, \"docx document numbering styles\");\r\n            styleContainer.appendChild(this.renderNumbering(document.numbering, styleContainer));\r\n        }\r\n\r\n        var sectionElements = this.renderSections(document.document);\r\n\r\n        if (this.inWrapper) {\r\n            var wrapper = this.renderWrapper();\r\n            appentElements(wrapper, sectionElements);\r\n            bodyContainer.appendChild(wrapper);\r\n        }\r\n        else {\r\n            appentElements(bodyContainer, sectionElements);\r\n        }\r\n    }\r\n\r\n    processClassName(className: string) {\r\n        if (!className)\r\n            return this.className;\r\n\r\n        return `${this.className}_${className}`;\r\n    }\r\n\r\n    processStyles(styles: IDomStyle[]) {\r\n        var stylesMap: Record<string, IDomStyle> = {};\r\n\r\n        for (let style of styles.filter(x => x.id != null)) {\r\n            stylesMap[style.id] = style;\r\n        }\r\n\r\n        for (let style of styles.filter(x => x.basedOn)) {\r\n            var baseStyle = stylesMap[style.basedOn];\r\n\r\n            if (baseStyle) {\r\n                for (let styleValues of style.styles) {\r\n                    var baseValues = baseStyle.styles.filter(x => x.target == styleValues.target);\r\n\r\n                    if (baseValues && baseValues.length > 0)\r\n                        this.copyStyleProperties(baseValues[0].values, styleValues.values);\r\n                }\r\n            }\r\n            else if (this.options.debug)\r\n                console.warn(`Can't find base style ${style.basedOn}`);\r\n        }\r\n\r\n        for (let style of styles) {\r\n            style.id = this.processClassName(style.id);\r\n        }\r\n\r\n        return stylesMap;\r\n    }\r\n\r\n    processElement(element: OpenXmlElement) {\r\n        if (element.children) {\r\n            for (var e of element.children) {\r\n                e.className = this.processClassName(e.className);\r\n\r\n                if (e.domType == DomType.Table) {\r\n                    this.processTable(e);\r\n                }\r\n                else {\r\n                    this.processElement(e);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    processTable(table: IDomTable) {\r\n        for (var r of table.children) {\r\n            for (var c of r.children) {\r\n                c.style = this.copyStyleProperties(table.cellStyle, c.style, [\r\n                    \"border-left\", \"border-right\", \"border-top\", \"border-bottom\",\r\n                    \"padding-left\", \"padding-right\", \"padding-top\", \"padding-bottom\"\r\n                ]);\r\n\r\n                this.processElement(c);\r\n            }\r\n        }\r\n    }\r\n\r\n    copyStyleProperties(input: IDomStyleValues, output: IDomStyleValues, attrs: string[] = null): IDomStyleValues {\r\n        if (!input)\r\n            return output;\r\n\r\n        if (output == null) output = {};\r\n        if (attrs == null) attrs = Object.getOwnPropertyNames(input);\r\n\r\n        for (var key of attrs) {\r\n            if (input.hasOwnProperty(key) && !output.hasOwnProperty(key))\r\n                output[key] = input[key];\r\n        }\r\n\r\n        return output;\r\n    }\r\n\r\n    createSection(className: string, props: SectionProperties) {\r\n        var elem = this.htmlDocument.createElement(\"section\");\r\n        \r\n        elem.className = className;\r\n\r\n        if (props) {\r\n            if (props.pageMargins) {\r\n                elem.style.paddingLeft = this.renderLength(props.pageMargins.left);\r\n                elem.style.paddingRight = this.renderLength(props.pageMargins.right);\r\n                elem.style.paddingTop = this.renderLength(props.pageMargins.top);\r\n                elem.style.paddingBottom = this.renderLength(props.pageMargins.bottom);\r\n            }\r\n\r\n            if (props.pageSize) {\r\n                if (!this.options.ignoreWidth)\r\n                    elem.style.width = this.renderLength(props.pageSize.width);\r\n                if (!this.options.ignoreHeight)\r\n                    elem.style.minHeight = this.renderLength(props.pageSize.height);\r\n            }\r\n\r\n            if (props.columns && props.columns.numberOfColumns) {\r\n                elem.style.columnCount = `${props.columns.numberOfColumns}`;\r\n                elem.style.columnGap = this.renderLength(props.columns.space);\r\n\r\n                if (props.columns.separator) {\r\n                    elem.style.columnRule = \"1px solid black\";\r\n                }\r\n            }\r\n        }\r\n\r\n        return elem;\r\n    }\r\n\r\n    renderSections(document: DocumentElement): HTMLElement[] {\r\n        var result = [];\r\n\r\n        this.processElement(document);\r\n\r\n        for(let section of this.splitBySection(document.children)) {\r\n            var sectionElement = this.createSection(this.className, section.sectProps || document.props);\r\n            this.renderElements(section.elements, document, sectionElement);\r\n            result.push(sectionElement);\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    splitBySection(elements: OpenXmlElement[]): { sectProps: SectionProperties, elements: OpenXmlElement[] }[] {\r\n        var current = { sectProps: null, elements: [] };\r\n        var result = [current];\r\n\r\n        for(let elem of elements) {\r\n            current.elements.push(elem);\r\n\r\n            if(elem.domType == DomType.Paragraph)\r\n            {\r\n                const p = elem as ParagraphElement;\r\n                var sectProps = p.props.sectionProps;\r\n                var breakIndex = this.options.breakPages ? (p.children && p.children.findIndex(x => (<any>x).break == \"page\")) : -1;\r\n    \r\n                if(sectProps || breakIndex != -1) {\r\n                    current.sectProps = sectProps;\r\n                    current = { sectProps: null, elements: [] };\r\n                    result.push(current);\r\n                }\r\n\r\n                if(breakIndex != -1 && breakIndex < p.children.length - 1) {\r\n                    var children = elem.children;\r\n                    var newParagraph = { ...elem, children: children.slice(breakIndex) };\r\n                    elem.children = children.slice(0, breakIndex);\r\n                    current.elements.push(newParagraph);\r\n                }\r\n            }\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    renderLength(l: Length): string {\r\n        return !l ? null : `${l.value}${l.type}`;\r\n    }\r\n\r\n    renderWrapper() {\r\n        var wrapper = document.createElement(\"div\");\r\n\r\n        wrapper.className = `${this.className}-wrapper`\r\n\r\n        return wrapper;\r\n    }\r\n\r\n    renderDefaultStyle() {\r\n        var styleText = `.${this.className}-wrapper { background: gray; padding: 30px; padding-bottom: 0px; display: flex; flex-flow: column; align-items: center; } \r\n                .${this.className}-wrapper section.${this.className} { background: white; box-shadow: 0 0 10px rgba(0, 0, 0, 0.5); margin-bottom: 30px; }\r\n                .${this.className} { color: black; }\r\n                section.${this.className} { box-sizing: border-box; }\r\n                .${this.className} table { border-collapse: collapse; }\r\n                .${this.className} table td, .${this.className} table th { vertical-align: top; }\r\n                .${this.className} p { margin: 0pt; }`;\r\n\r\n        return createStyleElement(styleText);\r\n    }\r\n\r\n    renderNumbering(styles: IDomNumbering[], styleContainer: HTMLElement) {\r\n        var styleText = \"\";\r\n        var rootCounters = [];\r\n\r\n        for (var num of styles) {\r\n            var selector = `p.${this.numberingClass(num.id, num.level)}`;\r\n            var listStyleType = \"none\";\r\n\r\n            if (num.levelText && num.format == \"decimal\") {\r\n                let counter = this.numberingCounter(num.id, num.level);\r\n\r\n                if (num.level > 0) {\r\n                    styleText += this.styleToString(`p.${this.numberingClass(num.id, num.level - 1)}`, {\r\n                        \"counter-reset\": counter\r\n                    });\r\n                }\r\n                else {\r\n                    rootCounters.push(counter);\r\n                }\r\n\r\n                styleText += this.styleToString(`${selector}:before`, {\r\n                    \"content\": this.levelTextToContent(num.levelText, num.id),\r\n                    \"counter-increment\": counter\r\n                });\r\n\r\n                styleText += this.styleToString(selector, {\r\n                    \"display\": \"list-item\",\r\n                    \"list-style-position\": \"inside\",\r\n                    \"list-style-type\": \"none\",\r\n                    ...num.style\r\n                });\r\n            }\r\n            else if (num.bullet) {\r\n                let valiable = `--${this.className}-${num.bullet.src}`.toLowerCase();\r\n\r\n                styleText += this.styleToString(`${selector}:before`, {\r\n                    \"content\": \"' '\",\r\n                    \"display\": \"inline-block\",\r\n                    \"background\": `var(${valiable})`\r\n                }, num.bullet.style);\r\n\r\n                this.document.loadNumberingImage(num.bullet.src).then(data => {\r\n                    var text = `.${this.className}-wrapper { ${valiable}: url(${data}) }`;\r\n                    styleContainer.appendChild(createStyleElement(text));\r\n                });\r\n            }\r\n            else {\r\n                listStyleType = this.numFormatToCssValue(num.format);\r\n            }\r\n\r\n            styleText += this.styleToString(selector, {\r\n                \"display\": \"list-item\",\r\n                \"list-style-position\": \"inside\",\r\n                \"list-style-type\": listStyleType,\r\n                ...num.style\r\n            });\r\n        }\r\n\r\n        if (rootCounters.length > 0) {\r\n            styleText += this.styleToString(`.${this.className}-wrapper`, {\r\n                \"counter-reset\": rootCounters.join(\" \")\r\n            });\r\n        }\r\n\r\n        return createStyleElement(styleText);\r\n    }\r\n\r\n    renderStyles(styles: IDomStyle[]): HTMLElement {\r\n        var styleText = \"\";\r\n        var stylesMap = this.processStyles(styles);\r\n\r\n        for (let style of styles) {\r\n            var subStyles =  style.styles;\r\n\r\n            if(style.linked) {\r\n                var linkedStyle = style.linked && stylesMap[style.linked];\r\n\r\n                if (linkedStyle)\r\n                    subStyles = subStyles.concat(linkedStyle.styles);\r\n                else if(this.options.debug)\r\n                    console.warn(`Can't find linked style ${style.linked}`);\r\n            }\r\n\r\n            for (var subStyle of subStyles) {\r\n                var selector = \"\";\r\n\r\n                if (style.target == subStyle.target)\r\n                    selector += `${style.target}.${style.id}`;\r\n                else if (style.target)\r\n                    selector += `${style.target}.${style.id} ${subStyle.target}`;\r\n                else\r\n                    selector += `.${style.id} ${subStyle.target}`;\r\n\r\n                if (style.isDefault && style.target)\r\n                    selector = `.${this.className} ${style.target}, ` + selector;\r\n\r\n                styleText += this.styleToString(selector, subStyle.values);\r\n            }\r\n        }\r\n\r\n        return createStyleElement(styleText);\r\n    }\r\n\r\n    renderElement(elem: OpenXmlElement, parent: OpenXmlElement): HTMLElement {\r\n        switch (elem.domType) {\r\n            case DomType.Paragraph:\r\n                return this.renderParagraph(<ParagraphElement>elem);\r\n\r\n            case DomType.Run:\r\n                return this.renderRun(<IDomRun>elem);\r\n\r\n            case DomType.Table:\r\n                return this.renderTable(elem);\r\n\r\n            case DomType.Row:\r\n                return this.renderTableRow(elem);\r\n\r\n            case DomType.Cell:\r\n                return this.renderTableCell(elem);\r\n\r\n            case DomType.Hyperlink:\r\n                return this.renderHyperlink(elem);\r\n\r\n            case DomType.Drawing:\r\n                return this.renderDrawing(<IDomImage>elem);\r\n\r\n            case DomType.Image:\r\n                return this.renderImage(<IDomImage>elem);\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    renderChildren(elem: OpenXmlElement, into?: HTMLElement): HTMLElement[] {\r\n        return this.renderElements(elem.children, elem, into);\r\n    }\r\n\r\n    renderElements(elems: OpenXmlElement[], parent: OpenXmlElement, into?: HTMLElement): HTMLElement[] {\r\n        if(elems == null)\r\n            return null;\r\n\r\n        var result = elems.map(e => this.renderElement(e, parent)).filter(e => e != null);\r\n\r\n        if(into)\r\n            for(let c of result)\r\n                into.appendChild(c);\r\n\r\n        return result;\r\n    }\r\n\r\n    renderParagraph(elem: ParagraphElement) {\r\n        var result = this.htmlDocument.createElement(\"p\");\r\n\r\n        this.renderClass(elem, result);\r\n        this.renderChildren(elem, result);\r\n        this.renderStyleValues(elem.style, result);\r\n\r\n        this.renderCommonProeprties(result, elem.props);\r\n\r\n        if (elem.numberingId && elem.numberingLevel != null) {\r\n            result.className = `${result.className} ${this.numberingClass(elem.numberingId, elem.numberingLevel)}`;\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    renderCommonProeprties(elem: HTMLElement, props: CommonProperties){\r\n        if(props == null)\r\n            return;\r\n\r\n        if(props.color) {\r\n            elem.style.color = props.color;\r\n        }\r\n\r\n        if (props.fontSize) {\r\n            elem.style.fontSize = this.renderLength(props.fontSize);\r\n        }\r\n    }\r\n\r\n    renderHyperlink(elem: IDomHyperlink) {\r\n        var result = this.htmlDocument.createElement(\"a\");\r\n\r\n        this.renderChildren(elem, result);\r\n        this.renderStyleValues(elem.style, result);\r\n\r\n        if (elem.href)\r\n            result.href = elem.href\r\n\r\n        return result;\r\n    }\r\n\r\n    renderDrawing(elem: IDomImage) {\r\n        var result = this.htmlDocument.createElement(\"div\");\r\n\r\n        result.style.display = \"inline-block\";\r\n        result.style.position = \"relative\";\r\n        result.style.textIndent = \"0px\";\r\n\r\n        this.renderChildren(elem, result);\r\n        this.renderStyleValues(elem.style, result);\r\n\r\n        return result;\r\n    }\r\n\r\n    renderImage(elem: IDomImage) {\r\n        let result = this.htmlDocument.createElement(\"img\");\r\n\r\n        this.renderStyleValues(elem.style, result);\r\n\r\n        if (this.document) {\r\n            this.document.loadDocumentImage(elem.src).then(x => {\r\n                result.src = x;\r\n            });\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    renderRun(elem: IDomRun) {\r\n        if (elem.break)\r\n            return elem.break == \"page\" ? null : this.htmlDocument.createElement(\"br\");\r\n\r\n        var result = this.htmlDocument.createElement(\"span\");\r\n\r\n        if (elem.text)\r\n            result.textContent = elem.text;\r\n\r\n        this.renderClass(elem, result);\r\n        this.renderChildren(elem, result);\r\n        this.renderStyleValues(elem.style, result);\r\n\r\n        if (elem.id) {\r\n            result.id = elem.id;\r\n        }\r\n\r\n        if (elem.tab) {\r\n            //TODO\r\n            // result.style.display = \"inline-block\";\r\n\r\n            // var paragraph = <IDomParagraph>elem.parent;\r\n\r\n            // while (paragraph != null && paragraph.domType != DomType.Paragraph)\r\n            //     paragraph = <IDomParagraph>paragraph.parent;\r\n\r\n            // if (paragraph && paragraph.tabs) {\r\n            //     var tab = paragraph.tabs[0];\r\n\r\n            //     result.style.width = tab.position;\r\n\r\n            //     switch (tab.leader) {\r\n            //         case \"dot\":\r\n            //         case \"middleDot\":\r\n            //             result.style.borderBottom = \"1px black dotted\";\r\n            //             break;\r\n\r\n            //         case \"hyphen\":\r\n            //         case \"heavy\":\r\n            //         case \"underscore\":\r\n            //             result.style.borderBottom = \"1px black solid\";\r\n            //             break;\r\n            //     }\r\n            // }\r\n        }\r\n        else if (elem.href) {\r\n            var link = this.htmlDocument.createElement(\"a\");\r\n\r\n            link.href = elem.href;\r\n            link.appendChild(result);\r\n\r\n            return link;\r\n        }\r\n        else if (elem.wrapper) {\r\n            var wrapper = this.htmlDocument.createElement(elem.wrapper);\r\n            wrapper.appendChild(result);\r\n            return wrapper;\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    renderTable(elem: IDomTable) {\r\n        let result = this.htmlDocument.createElement(\"table\");\r\n\r\n        this.renderClass(elem, result);\r\n        this.renderChildren(elem, result);\r\n        this.renderStyleValues(elem.style, result);\r\n\r\n        if (elem.columns)\r\n            result.appendChild(this.renderTableColumns(elem.columns));\r\n\r\n        return result;\r\n    }\r\n\r\n    renderTableColumns(columns: IDomTableColumn[]) {\r\n        let result = this.htmlDocument.createElement(\"colGroup\");\r\n\r\n        for (let col of columns) {\r\n            let colElem = this.htmlDocument.createElement(\"col\");\r\n\r\n            if (col.width)\r\n                colElem.style.width = `${col.width}px`;\r\n\r\n            result.appendChild(colElem);\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    renderTableRow(elem: OpenXmlElement) {\r\n        let result = this.htmlDocument.createElement(\"tr\");\r\n\r\n        this.renderClass(elem, result);\r\n        this.renderChildren(elem, result);\r\n        this.renderStyleValues(elem.style, result);\r\n\r\n        return result;\r\n    }\r\n\r\n    renderTableCell(elem: IDomTableCell) {\r\n        let result = this.htmlDocument.createElement(\"td\");\r\n\r\n        this.renderClass(elem, result);\r\n        this.renderChildren(elem, result);\r\n        this.renderStyleValues(elem.style, result);\r\n\r\n        if (elem.span) result.colSpan = elem.span;\r\n\r\n        return result;\r\n    }\r\n\r\n    renderStyleValues(style: IDomStyleValues, ouput: HTMLElement) {\r\n        if (style == null)\r\n            return;\r\n\r\n        for (let key in style) {\r\n            if (style.hasOwnProperty(key)) {\r\n                ouput.style[key] = style[key];\r\n            }\r\n        }\r\n    }\r\n\r\n    renderClass(input: OpenXmlElement, ouput: HTMLElement) {\r\n        if (input.className)\r\n            ouput.className = input.className;\r\n    }\r\n\r\n    numberingClass(id, lvl) {\r\n        return `${this.className}-num-${id}-${lvl}`;\r\n    }\r\n\r\n    styleToString(selectors: string, values: IDomStyleValues, cssText: string = null) {\r\n        let result = selectors + \" {\\r\\n\";\r\n\r\n        for (const key in values) {\r\n            result += `  ${key}: ${values[key]};\\r\\n`;\r\n        }\r\n\r\n        if (cssText)\r\n            result += \";\" + cssText;\r\n\r\n        return result + \"}\\r\\n\";\r\n    }\r\n\r\n    numberingCounter(id, lvl) {\r\n        return `${this.className}-num-${id}-${lvl}`;\r\n    }\r\n\r\n    levelTextToContent(text: string, id: string) {\r\n        var result = text.replace(/%\\d*/g, s => {\r\n            let lvl = parseInt(s.substring(1), 10) - 1;\r\n            return `\"counter(${this.numberingCounter(id, lvl)})\"`;\r\n        });\r\n\r\n        return '\"' + result + '\"';\r\n    }\r\n\r\n    numFormatToCssValue(format: string) {\r\n        var mapping = {\r\n            \"none\": \"none\",\r\n            \"bullet\": \"disc\",\r\n            \"decimal\": \"decimal\",\r\n            \"lowerLetter\": \"lower-alpha\",\r\n            \"upperLetter\": \"upper-alpha\",\r\n            \"lowerRoman\": \"lower-roman\",\r\n            \"upperRoman\": \"upper-roman\",\r\n        };\r\n\r\n        return mapping[format] || format;\r\n    }\r\n}\r\n\r\nfunction appentElements(container: HTMLElement, children: HTMLElement[]) {\r\n    for (let c of children)\r\n        container.appendChild(c);\r\n}\r\n\r\nfunction removeAllElements(elem: HTMLElement) {\r\n    while (elem.firstChild) {\r\n        elem.removeChild(elem.firstChild);\r\n    }\r\n}\r\n\r\nfunction createStyleElement(cssText: string) {\r\n    var styleElement = document.createElement(\"style\");\r\n    styleElement.type = \"text/css\";\r\n    styleElement.innerHTML = cssText;\r\n    return styleElement;\r\n}\r\n\r\nfunction appendComment(elem: HTMLElement, comment: string) {\r\n    elem.appendChild(document.createComment(comment));\r\n}"],"sourceRoot":""}